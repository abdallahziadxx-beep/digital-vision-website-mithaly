<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الميثالي للتجارة | نظام الطلبات المتكامل</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root {
            --primary: #064e3b;
            --secondary: #059669;
            --accent: #f59e0b;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
        }
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }
        
        .slide-in-right {
            animation: slideInRight 0.3s ease forwards;
        }
        
        /* Glass Effect */
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Card Styling */
        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-5px);
        }
        
        /* Status Badges */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-processing {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .status-completed {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-cancelled {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
        
        /* Gradient Text */
        .gradient-text {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        /* Tab Styling */
        .tab-btn {
            padding: 0.75rem 1.5rem;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .tab-btn.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: bold;
        }
        
        /* Notification Dot */
        .notification-dot {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            background-color: var(--danger);
            border-radius: 50%;
        }
        
        /* Admin Sidebar */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, var(--dark) 0%, #0f172a 100%);
        }
        
        /* Admin Nav Item */
        .admin-nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: #cbd5e1;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            margin-bottom: 0.25rem;
            cursor: pointer;
        }
        
        .admin-nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .admin-nav-item.active {
            background: rgba(5, 150, 105, 0.2);
            color: white;
            border-right: 3px solid var(--secondary);
        }
        
        /* Mobile Menu */
        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 320px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1000;
        }
        
        .mobile-menu.open {
            right: 0;
        }
        
        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }
        
        .overlay.active {
            display: block;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            display: none;
        }
        
        .modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* Product Card */
        .product-card {
            position: relative;
            overflow: hidden;
        }
        
        .product-card .product-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 2;
        }
        
        /* Floating Action Buttons */
        .fab {
            position: fixed;
            bottom: 24px;
            left: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(6, 78, 59, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(6, 78, 59, 0.4);
        }
        
        .fab-small {
            width: 44px;
            height: 44px;
            bottom: 90px;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 9999;
            animation: slideInRight 0.3s ease;
        }
        
        .toast.success {
            border-right: 4px solid var(--secondary);
        }
        
        .toast.error {
            border-right: 4px solid var(--danger);
        }
        
        .toast.info {
            border-right: 4px solid var(--info);
        }
        
        /* Pulse Animation */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Logo Image */
        .logo-img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        /* Founder Image */
        .founder-img {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 50%;
            border: 5px solid white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <!-- App Container -->
    <div id="app">
        <!-- سيتم تحميل المحتوى هنا ديناميكياً -->
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Templates -->
    <template id="customer-template">
        <!-- واجهة العملاء -->
        <div class="min-h-screen">
            <!-- Top Navigation -->
            <nav class="glass sticky top-0 z-40">
                <div class="container mx-auto px-4 py-3">
                    <div class="flex justify-between items-center">
                        <!-- Logo -->
                        <div class="flex items-center gap-3">
                            <div id="logo-container" class="w-10 h-10 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center">
                                <!-- سيتم تحميل الشعار هنا -->
                            </div>
                            <div>
                                <h1 class="text-xl font-bold text-gray-800 company-name">الميثالي للتجارة</h1>
                                <p class="text-xs text-gray-600">حراثات وقطع غيار أصلية</p>
                            </div>
                        </div>
                        
                        <!-- Desktop Menu -->
                        <div class="hidden lg:flex items-center gap-6">
                            <a href="#" onclick="app.loadCustomerPage('home')" class="text-gray-700 hover:text-green-600 font-medium">الرئيسية</a>
                            <a href="#" onclick="app.loadCustomerPage('products')" class="text-gray-700 hover:text-green-600 font-medium">المنتجات</a>
                            <a href="#" onclick="app.loadCustomerPage('about')" class="text-gray-700 hover:text-green-600 font-medium">معلومات حولنا</a>
                            <a href="#" onclick="app.loadCustomerPage('contact')" class="text-gray-700 hover:text-green-600 font-medium">اتصل بنا</a>
                        </div>
                        
                        <!-- Actions -->
                        <div class="flex items-center gap-4">
                            <button onclick="app.showCart()" class="relative p-2 text-gray-700 hover:text-green-600">
                                <i class="fas fa-shopping-cart text-xl"></i>
                                <span id="cart-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                            </button>
                            <button onclick="app.showQuickOrder()" class="hidden md:inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                <i class="fas fa-bolt"></i>
                                <span>طلب سريع</span>
                            </button>
                            <button onclick="app.toggleMobileMenu()" class="lg:hidden text-gray-700">
                                <i class="fas fa-bars text-xl"></i>
                            </button>
                            <button onclick="app.showAdminLogin()" class="hidden md:inline-flex items-center gap-2 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900">
                                <i class="fas fa-user-cog"></i>
                                <span>تسجيل دخول المدير</span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobile-menu">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-8">
                        <h2 class="text-xl font-bold text-gray-800">القائمة</h2>
                        <button onclick="app.toggleMobileMenu()" class="text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="space-y-2">
                        <a href="#" onclick="app.loadCustomerPage('home')" class="flex items-center gap-3 p-3 rounded-lg bg-green-50 text-green-700">
                            <i class="fas fa-home"></i>
                            <span>الرئيسية</span>
                        </a>
                        <a href="#" onclick="app.loadCustomerPage('products')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100">
                            <i class="fas fa-box"></i>
                            <span>المنتجات</span>
                        </a>
                        <a href="#" onclick="app.loadCustomerPage('about')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100">
                            <i class="fas fa-info-circle"></i>
                            <span>معلومات حولنا</span>
                        </a>
                        <a href="#" onclick="app.loadCustomerPage('contact')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100">
                            <i class="fas fa-headset"></i>
                            <span>اتصل بنا</span>
                        </a>
                        <a href="#" onclick="app.showAdminLogin()" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-100 mt-4">
                            <i class="fas fa-user-cog"></i>
                            <span>تسجيل دخول المدير</span>
                        </a>
                        <button onclick="app.showQuickOrder()" class="w-full flex items-center gap-3 p-3 rounded-lg bg-green-600 text-white hover:bg-green-700 mt-4">
                            <i class="fas fa-bolt"></i>
                            <span>طلب سريع</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Overlay -->
            <div class="overlay" id="overlay" onclick="app.closeMobileMenu(); app.closeModal();"></div>

            <!-- Main Content -->
            <main id="customer-content" class="container mx-auto px-4 py-6">
                <!-- سيتم تحميل المحتوى هنا -->
            </main>

            <!-- Floating Action Buttons -->
            <div class="fab-container">
                <button onclick="app.showWhatsApp()" class="fab pulse">
                    <i class="fab fa-whatsapp text-xl"></i>
                </button>
                <button onclick="app.showQuickOrder()" class="fab fab-small">
                    <i class="fas fa-bolt"></i>
                </button>
            </div>

            <!-- Footer -->
            <footer class="bg-gray-900 text-white mt-12">
                <div class="container mx-auto px-4 py-8">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div>
                            <h3 class="text-xl font-bold mb-4 footer-company-name">الميثالي للتجارة</h3>
                            <p class="text-gray-400">رواد تجارة المعدات الزراعية في اليمن منذ 1995</p>
                        </div>
                        <div>
                            <h4 class="font-bold mb-4">روابط سريعة</h4>
                            <ul class="space-y-2">
                                <li><a href="#" onclick="app.loadCustomerPage('home')" class="text-gray-400 hover:text-white">الرئيسية</a></li>
                                <li><a href="#" onclick="app.loadCustomerPage('products')" class="text-gray-400 hover:text-white">المنتجات</a></li>
                                <li><a href="#" onclick="app.loadCustomerPage('about')" class="text-gray-400 hover:text-white">معلومات حولنا</a></li>
                                <li><a href="#" onclick="app.loadCustomerPage('contact')" class="text-gray-400 hover:text-white">اتصل بنا</a></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold mb-4">تواصل معنا</h4>
                            <div class="space-y-2">
                                <p class="text-gray-400"><i class="fas fa-phone ml-2"></i> <span id="footer-phone">775555590</span></p>
                                <p class="text-gray-400"><i class="fab fa-whatsapp ml-2"></i> <span id="footer-whatsapp">967775555590</span></p>
                                <p class="text-gray-400"><i class="fas fa-map-marker-alt ml-2"></i> <span id="footer-address">صنعاء، اليمن</span></p>
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                        <p>© 2024 الميثالي للتجارة. جميع الحقوق محفوظة.</p>
                    </div>
                </div>
            </footer>
        </div>
    </template>

    <template id="admin-template">
        <!-- واجهة المدير -->
        <div class="min-h-screen flex">
            <!-- Sidebar -->
            <div class="sidebar w-64 flex-shrink-0">
                <div class="p-6">
                    <div class="flex items-center gap-3 mb-8">
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-700 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-cog text-white text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-white">لوحة التحكم</h2>
                            <p class="text-gray-400 text-sm">الميثالي للتجارة</p>
                        </div>
                    </div>
                    
                    <nav class="space-y-1">
                        <a href="#" onclick="app.loadAdminPage('dashboard')" class="admin-nav-item active">
                            <i class="fas fa-chart-line ml-3"></i>
                            <span>لوحة التحكم</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('products')" class="admin-nav-item">
                            <i class="fas fa-box ml-3"></i>
                            <span>المنتجات</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('categories')" class="admin-nav-item">
                            <i class="fas fa-tags ml-3"></i>
                            <span>الأصناف</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('orders')" class="admin-nav-item">
                            <i class="fas fa-shopping-cart ml-3"></i>
                            <span>الطلبات</span>
                            <span id="admin-orders-count" class="mr-auto bg-red-500 text-white text-xs rounded-full px-2 py-1 hidden">0</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('customers')" class="admin-nav-item">
                            <i class="fas fa-users ml-3"></i>
                            <span>العملاء</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('messages')" class="admin-nav-item">
                            <i class="fas fa-envelope ml-3"></i>
                            <span>الرسائل</span>
                            <span id="admin-messages-count" class="mr-auto bg-blue-500 text-white text-xs rounded-full px-2 py-1 hidden">0</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('currencies')" class="admin-nav-item">
                            <i class="fas fa-money-bill-wave ml-3"></i>
                            <span>العملات</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('fileManagement')" class="admin-nav-item">
                            <i class="fas fa-file-alt ml-3"></i>
                            <span>إدارة الملفات</span>
                        </a>
                        <a href="#" onclick="app.loadAdminPage('settings')" class="admin-nav-item">
                            <i class="fas fa-cog ml-3"></i>
                            <span>الإعدادات</span>
                        </a>
                        <a href="#" onclick="app.logout()" class="admin-nav-item text-red-300 hover:bg-red-900/30">
                            <i class="fas fa-sign-out-alt ml-3"></i>
                            <span>تسجيل الخروج</span>
                        </a>
                    </nav>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="flex-1 bg-gray-50">
                <!-- Top Bar -->
                <header class="bg-white border-b px-6 py-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 id="admin-page-title" class="text-xl font-bold text-gray-800">لوحة التحكم</h1>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="text-right">
                                <p class="font-bold text-gray-800" id="admin-username">المدير</p>
                                <p class="text-sm text-gray-600" id="admin-date">--</p>
                            </div>
                            <button onclick="app.toggleNotifications()" class="relative p-2 text-gray-600 hover:text-gray-900">
                                <i class="fas fa-bell text-xl"></i>
                                <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                            </button>
                        </div>
                    </div>
                </header>
                
                <!-- Notifications Dropdown -->
                <div id="notifications-dropdown" class="absolute left-4 mt-2 w-80 bg-white rounded-lg shadow-lg border hidden z-50">
                    <!-- سيتم تحميل الإشعارات هنا -->
                </div>
                
                <!-- Page Content -->
                <main id="admin-content" class="p-6">
                    <!-- سيتم تحميل محتوى الصفحة هنا -->
                </main>
            </div>
        </div>
    </template>

    <script>
        // ==================== نظام إدارة الملفات ====================
        class FileManager {
            constructor() {
                this.configFile = 'config.json';
                this.currentData = null;
            }
            
            // تحميل البيانات من الملف
            async loadConfig() {
                try {
                    const response = await fetch(this.configFile);
                    if (!response.ok) throw new Error('لم يتم العثور على ملف التكوين');
                    
                    this.currentData = await response.json();
                    console.log('تم تحميل الإعدادات من الملف:', this.currentData);
                    return this.currentData;
                } catch (error) {
                    console.error('خطأ في تحميل الإعدادات:', error);
                    return this.loadDefaultConfig();
                }
            }
            
            // تحميل الإعدادات الافتراضية
            loadDefaultConfig() {
                const defaultConfig = {
                    "version": "3.0",
                    "settings": {
                        "companyName": "الميثالي للتجارة",
                        "phone": "775555590",
                        "whatsapp": "967775555590",
                        "email": "info@mithali.com",
                        "address": "صنعاء، اليمن",
                        "currency": "ريال يمني",
                        "taxRate": 5,
                        "shippingCost": 50000,
                        "adminPassword": "admin123",
                        "logo": "",
                        "founderName": "محمد الميثالي",
                        "founderPosition": "المؤسس والرئيس التنفيذي",
                        "founderBio": "مؤسس شركة الميثالي للتجارة بخبرة تزيد عن 30 عاماً في مجال المعدات الزراعية",
                        "founderImage": "https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                    },
                    "currencies": [
                        { "id": 1, "code": "ريال يمني", "symbol": "ر.ي", "rate": 1, "isDefault": true },
                        { "id": 2, "code": "دولار", "symbol": "$", "rate": 530, "isDefault": false },
                        { "id": 3, "code": "ريال سعودي", "symbol": "ر.س", "rate": 141, "isDefault": false }
                    ],
                    "categories": [
                        { "id": 1, "name": "جرارات", "description": "جميع أنواع الجرارات والحراثات", "image": "https://images.unsplash.com/photo-1577471488278-16eec37ffcc2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" },
                        { "id": 2, "name": "قطع غيار", "description": "قطع غيار أصلية للجرارات والمعدات الزراعية", "image": "https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" },
                        { "id": 3, "name": "إطارات", "description": "إطارات زراعية وجرارات", "image": "https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" },
                        { "id": 4, "name": "محركات", "description": "محركات ديزل وجرارات", "image": "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" }
                    ],
                    "products": [
                        {
                            "id": 1,
                            "name": "حراثة Indo Farm 4WD",
                            "description": "حراثة قوية 4x4 بمحرك ديزل 45 حصان، مناسبة للأراضي اليمنية الوعرة.",
                            "category": "جرارات",
                            "price": 125000000,
                            "stock": 8,
                            "minStock": 3,
                            "status": "متوفر",
                            "image": "https://images.unsplash.com/photo-1577471488278-16eec37ffcc2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                            "features": ["4x4 دفع رباعي", "45 حصان", "ديزل", "ناقل حركة ميكانيكي"],
                            "createdAt": "2024-01-15"
                        },
                        {
                            "id": 2,
                            "name": "فلتر ديزل أصلي",
                            "description": "فلتر ديزل عالي الجودة يناسب معظم موديلات الجرارات.",
                            "category": "قطع غيار",
                            "price": 45000,
                            "stock": 50,
                            "minStock": 10,
                            "status": "متوفر",
                            "image": "https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                            "features": ["أصلي", "عالي الجودة", "طويل الأمد"],
                            "createdAt": "2024-01-10"
                        },
                        {
                            "id": 3,
                            "name": "إطارات زراعية 16.9-30",
                            "description": "إطارات زراعية عالية الجودة مصممة للتربة الرطبة والجافة.",
                            "category": "إطارات",
                            "price": 850000,
                            "stock": 15,
                            "minStock": 5,
                            "status": "متوفر",
                            "image": "https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                            "features": ["مقاس 16.9-30", "عمر طويل", "مناسب لجميع الترب"],
                            "createdAt": "2024-01-12"
                        }
                    ],
                    "orders": [],
                    "customers": [],
                    "messages": [],
                    "cart": [],
                    "notifications": []
                };
                
                this.currentData = defaultConfig;
                return defaultConfig;
            }
            
            // حفظ البيانات إلى localStorage
            saveToLocalStorage(config) {
                if (!config) return;
                
                localStorage.setItem('mithali_settings', JSON.stringify(config.settings || {}));
                localStorage.setItem('mithali_currencies', JSON.stringify(config.currencies || []));
                localStorage.setItem('mithali_categories', JSON.stringify(config.categories || []));
                localStorage.setItem('mithali_products', JSON.stringify(config.products || []));
                localStorage.setItem('mithali_orders', JSON.stringify(config.orders || []));
                localStorage.setItem('mithali_customers', JSON.stringify(config.customers || []));
                localStorage.setItem('mithali_messages', JSON.stringify(config.messages || []));
                localStorage.setItem('mithali_cart', JSON.stringify(config.cart || []));
                localStorage.setItem('mithali_notifications', JSON.stringify(config.notifications || []));
                localStorage.setItem('mithali_version', config.version || '3.0');
                
                console.log('تم حفظ الإعدادات في localStorage');
            }
            
            // تحميل البيانات من localStorage
            loadFromLocalStorage() {
                const config = {
                    version: localStorage.getItem('mithali_version') || '3.0',
                    settings: JSON.parse(localStorage.getItem('mithali_settings') || '{}'),
                    currencies: JSON.parse(localStorage.getItem('mithali_currencies') || '[]'),
                    categories: JSON.parse(localStorage.getItem('mithali_categories') || '[]'),
                    products: JSON.parse(localStorage.getItem('mithali_products') || '[]'),
                    orders: JSON.parse(localStorage.getItem('mithali_orders') || '[]'),
                    customers: JSON.parse(localStorage.getItem('mithali_customers') || '[]'),
                    messages: JSON.parse(localStorage.getItem('mithali_messages') || '[]'),
                    cart: JSON.parse(localStorage.getItem('mithali_cart') || '[]'),
                    notifications: JSON.parse(localStorage.getItem('mithali_notifications') || '[]')
                };
                
                this.currentData = config;
                return config;
            }
            
            // تصدير البيانات إلى ملف
            async exportToFile(filename = 'mithali-config.json') {
                try {
                    const config = this.loadFromLocalStorage();
                    const dataStr = JSON.stringify(config, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', filename);
                    linkElement.click();
                    
                    console.log('تم تصدير البيانات إلى ملف:', filename);
                    return true;
                } catch (error) {
                    console.error('خطأ في تصدير البيانات:', error);
                    return false;
                }
            }
            
            // استيراد البيانات من ملف
            async importFromFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        try {
                            const config = JSON.parse(e.target.result);
                            this.currentData = config;
                            this.saveToLocalStorage(config);
                            console.log('تم استيراد البيانات من الملف:', file.name);
                            resolve(config);
                        } catch (error) {
                            console.error('خطأ في تحليل ملف JSON:', error);
                            reject(error);
                        }
                    };
                    
                    reader.onerror = (error) => {
                        console.error('خطأ في قراءة الملف:', error);
                        reject(error);
                    };
                    
                    reader.readAsText(file);
                });
            }
            
            // حفظ الصورة كـ base64
            async saveImageToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        resolve(e.target.result);
                    };
                    
                    reader.onerror = (error) => {
                        reject(error);
                    };
                    
                    reader.readAsDataURL(file);
                });
            }
            
            // تحديث البيانات الحالية
            updateCurrentData(newData) {
                this.currentData = { ...this.currentData, ...newData };
            }
            
            // الحصول على إعدادات معينة
            getSetting(key) {
                return this.currentData?.settings?.[key] || '';
            }
            
            // تحديث إعداد معين
            updateSetting(key, value) {
                if (this.currentData && this.currentData.settings) {
                    this.currentData.settings[key] = value;
                    this.saveToLocalStorage(this.currentData);
                }
            }
        }

        // ==================== نظام إدارة البيانات ====================
        class DataManager {
            constructor() {
                this.fileManager = new FileManager();
                this.initDatabase();
            }
            
            async initDatabase() {
                // أولاً حاول تحميل البيانات من الملف
                try {
                    const config = await this.fileManager.loadConfig();
                    this.fileManager.saveToLocalStorage(config);
                } catch (error) {
                    // إذا فشل، استخدم البيانات الافتراضية
                    console.log('استخدام البيانات الافتراضية');
                    this.fileManager.loadDefaultConfig();
                    this.fileManager.saveToLocalStorage(this.fileManager.currentData);
                }
                
                // تحقق من وجود localStorage
                if (!localStorage.getItem('mithali_settings')) {
                    const defaultConfig = this.fileManager.loadDefaultConfig();
                    this.fileManager.saveToLocalStorage(defaultConfig);
                }
            }
            
            // ============ وظائف عامة ============
            getSettings() {
                return JSON.parse(localStorage.getItem('mithali_settings') || '{}');
            }
            
            saveSettings(settings) {
                localStorage.setItem('mithali_settings', JSON.stringify(settings));
                this.addNotification('تم تحديث الإعدادات', 'تم حفظ التغييرات في إعدادات المتجر بنجاح');
            }
            
            // ============ إدارة العملات ============
            getCurrencies() {
                return JSON.parse(localStorage.getItem('mithali_currencies') || '[]');
            }
            
            getCurrency(id) {
                const currencies = this.getCurrencies();
                return currencies.find(c => c.id === id);
            }
            
            saveCurrency(currency) {
                let currencies = this.getCurrencies();
                
                if (currency.id) {
                    const index = currencies.findIndex(c => c.id === currency.id);
                    if (index !== -1) {
                        currencies[index] = currency;
                    }
                } else {
                    currency.id = Date.now();
                    currencies.push(currency);
                }
                
                localStorage.setItem('mithali_currencies', JSON.stringify(currencies));
                return currency;
            }
            
            deleteCurrency(id) {
                let currencies = this.getCurrencies();
                currencies = currencies.filter(c => c.id !== id);
                localStorage.setItem('mithali_currencies', JSON.stringify(currencies));
            }
            
            setDefaultCurrency(id) {
                let currencies = this.getCurrencies();
                currencies.forEach(c => c.isDefault = c.id === id);
                localStorage.setItem('mithali_currencies', JSON.stringify(currencies));
            }
            
            getDefaultCurrency() {
                const currencies = this.getCurrencies();
                return currencies.find(c => c.isDefault) || currencies[0] || { code: "ريال يمني", symbol: "ر.ي" };
            }
            
            // ============ إدارة الأصناف ============
            getCategories() {
                return JSON.parse(localStorage.getItem('mithali_categories') || '[]');
            }
            
            getCategory(id) {
                const categories = this.getCategories();
                return categories.find(c => c.id === id);
            }
            
            saveCategory(category) {
                let categories = this.getCategories();
                
                if (category.id) {
                    const index = categories.findIndex(c => c.id === category.id);
                    if (index !== -1) {
                        categories[index] = category;
                    }
                } else {
                    category.id = Date.now();
                    categories.push(category);
                }
                
                localStorage.setItem('mithali_categories', JSON.stringify(categories));
                return category;
            }
            
            deleteCategory(id) {
                let categories = this.getCategories();
                categories = categories.filter(c => c.id !== id);
                localStorage.setItem('mithali_categories', JSON.stringify(categories));
            }
            
            // ============ إدارة المنتجات ============
            getProducts() {
                return JSON.parse(localStorage.getItem('mithali_products') || '[]');
            }
            
            getProduct(id) {
                const products = this.getProducts();
                return products.find(p => p.id === id);
            }
            
            saveProduct(product) {
                let products = this.getProducts();
                
                if (product.id) {
                    const index = products.findIndex(p => p.id === product.id);
                    if (index !== -1) {
                        products[index] = product;
                    }
                } else {
                    product.id = Date.now();
                    product.createdAt = new Date().toISOString().split('T')[0];
                    products.push(product);
                }
                
                localStorage.setItem('mithali_products', JSON.stringify(products));
                return product;
            }
            
            deleteProduct(id) {
                let products = this.getProducts();
                products = products.filter(p => p.id !== id);
                localStorage.setItem('mithali_products', JSON.stringify(products));
            }
            
            // ============ إدارة الطلبات ============
            getOrders() {
                return JSON.parse(localStorage.getItem('mithali_orders') || '[]');
            }
            
            saveOrder(order) {
                let orders = this.getOrders();
                
                if (order.id) {
                    const index = orders.findIndex(o => o.id === order.id);
                    if (index !== -1) {
                        orders[index] = order;
                    }
                } else {
                    order.id = Date.now();
                    order.createdAt = new Date().toISOString();
                    orders.push(order);
                }
                
                localStorage.setItem('mithali_orders', JSON.stringify(orders));
                return order;
            }
            
            deleteOrder(id) {
                let orders = this.getOrders();
                orders = orders.filter(o => o.id !== id);
                localStorage.setItem('mithali_orders', JSON.stringify(orders));
            }
            
            // ============ إدارة العملاء ============
            getCustomers() {
                return JSON.parse(localStorage.getItem('mithali_customers') || '[]');
            }
            
            saveCustomer(customer) {
                let customers = this.getCustomers();
                
                const existingCustomer = customers.find(c => c.phone === customer.phone);
                
                if (existingCustomer) {
                    Object.assign(existingCustomer, customer);
                } else {
                    customer.id = Date.now();
                    customer.createdAt = new Date().toISOString();
                    customer.totalOrders = 0;
                    customer.totalSpent = 0;
                    customers.push(customer);
                }
                
                localStorage.setItem('mithali_customers', JSON.stringify(customers));
                return customer;
            }
            
            // ============ إدارة السلة ============
            getCart() {
                return JSON.parse(localStorage.getItem('mithali_cart') || '[]');
            }
            
            saveCart(cart) {
                localStorage.setItem('mithali_cart', JSON.stringify(cart));
            }
            
            clearCart() {
                localStorage.setItem('mithali_cart', JSON.stringify([]));
            }
            
            // ============ إدارة الرسائل ============
            getMessages() {
                return JSON.parse(localStorage.getItem('mithali_messages') || '[]');
            }
            
            saveMessage(message) {
                let messages = this.getMessages();
                message.id = Date.now();
                message.createdAt = new Date().toISOString();
                message.read = false;
                messages.unshift(message);
                localStorage.setItem('mithali_messages', JSON.stringify(messages));
                
                this.addNotification('رسالة جديدة', `رسالة من ${message.name}: ${message.message.substring(0, 50)}...`);
                
                return message;
            }
            
            markMessageAsRead(id) {
                let messages = this.getMessages();
                const message = messages.find(m => m.id === id);
                if (message) {
                    message.read = true;
                    localStorage.setItem('mithali_messages', JSON.stringify(messages));
                }
            }
            
            // ============ الإشعارات ============
            addNotification(title, message) {
                const notifications = JSON.parse(localStorage.getItem('mithali_notifications') || '[]');
                notifications.unshift({
                    id: Date.now(),
                    title,
                    message,
                    time: new Date().toLocaleTimeString('ar-YE'),
                    read: false
                });
                
                if (notifications.length > 50) {
                    notifications.pop();
                }
                
                localStorage.setItem('mithali_notifications', JSON.stringify(notifications));
            }
            
            getNotifications() {
                return JSON.parse(localStorage.getItem('mithali_notifications') || '[]');
            }
            
            markNotificationAsRead(id) {
                let notifications = this.getNotifications();
                const notification = notifications.find(n => n.id === id);
                if (notification) {
                    notification.read = true;
                    localStorage.setItem('mithali_notifications', JSON.stringify(notifications));
                }
            }
            
            getUnreadNotificationsCount() {
                const notifications = this.getNotifications();
                return notifications.filter(n => !n.read).length;
            }
            
            // ============ تسجيل دخول المدير ============
            checkAdminPassword(password) {
                const settings = this.getSettings();
                return password === settings.adminPassword;
            }
            
            changeAdminPassword(newPassword) {
                const settings = this.getSettings();
                settings.adminPassword = newPassword;
                this.saveSettings(settings);
                this.addNotification('تم تغيير كلمة المرور', 'تم تحديث كلمة مرور المدير بنجاح');
            }
            
            // ============ وظائف مساعدة ============
            formatCurrency(amount) {
                const defaultCurrency = this.getDefaultCurrency();
                return new Intl.NumberFormat('ar-YE').format(amount) + ` ${defaultCurrency.symbol || 'ر.ي'}`;
            }
            
            convertCurrency(amount, fromCurrencyId, toCurrencyId) {
                const currencies = this.getCurrencies();
                const fromCurrency = currencies.find(c => c.id === fromCurrencyId) || this.getDefaultCurrency();
                const toCurrency = currencies.find(c => c.id === toCurrencyId) || this.getDefaultCurrency();
                
                if (fromCurrency.id === toCurrency.id) return amount;
                
                const amountInDefault = amount / fromCurrency.rate;
                return amountInDefault * toCurrency.rate;
            }
            
            getStatusClass(status) {
                switch(status) {
                    case 'معلق': return 'status-pending';
                    case 'قيد المعالجة': return 'status-processing';
                    case 'مكتمل': return 'status-completed';
                    case 'ملغي': return 'status-cancelled';
                    default: return 'status-pending';
                }
            }
            
            calculateOrderStats() {
                const orders = this.getOrders();
                const today = new Date().toISOString().split('T')[0];
                
                return {
                    total: orders.length,
                    pending: orders.filter(o => o.status === 'معلق').length,
                    today: orders.filter(o => o.createdAt.split('T')[0] === today).length,
                    totalRevenue: orders.reduce((sum, order) => sum + (order.total || 0), 0)
                };
            }
            
            // ============ إدارة الصور ============
            uploadImage(file) {
                return new Promise((resolve, reject) => {
                    if (!file) {
                        resolve('');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        resolve(e.target.result);
                    };
                    reader.onerror = (e) => {
                        reject('خطأ في قراءة الصورة');
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        // ==================== نظام التطبيق الرئيسي ====================
        class MithaliApp {
            constructor() {
                this.dataManager = new DataManager();
                this.currentPage = 'home';
                this.init();
            }
            
            async init() {
                await this.dataManager.initDatabase();
                this.renderCustomerInterface();
                this.setupEventListeners();
                this.updateCartCount();
                this.updateDateTime();
                this.updateFooterInfo();
                this.updateLogo();
                setInterval(() => this.updateDateTime(), 60000);
            }
            
            // ============ التبديل بين الواجهات ============
            renderCustomerInterface() {
                const template = document.getElementById('customer-template');
                const content = template.content.cloneNode(true);
                document.getElementById('app').innerHTML = '';
                document.getElementById('app').appendChild(content);
                
                this.setupCustomerEvents();
                this.loadCustomerPage('home');
                this.updateFooterInfo();
                this.updateLogo();
            }
            
            renderAdminInterface() {
                const template = document.getElementById('admin-template');
                const content = template.content.cloneNode(true);
                document.getElementById('app').innerHTML = '';
                document.getElementById('app').appendChild(content);
                
                this.setupAdminEvents();
                this.loadAdminPage('dashboard');
                this.updateAdminStats();
            }
            
            // ============ إعداد الأحداث ============
            setupEventListeners() {
                document.addEventListener('click', (e) => {
                    if (e.target.id === 'overlay') {
                        this.closeMobileMenu();
                        this.closeModal();
                    }
                });
            }
            
            setupCustomerEvents() {
                const mobileMenuBtn = document.querySelector('[onclick*="toggleMobileMenu"]');
                if (mobileMenuBtn) {
                    mobileMenuBtn.onclick = () => this.toggleMobileMenu();
                }
                
                this.updateCartCount();
                this.updateFooterInfo();
                this.updateLogo();
            }
            
            setupAdminEvents() {
                this.updateDateTime();
            }
            
            // ============ تحديث الشعار ============
            updateLogo() {
                const settings = this.dataManager.getSettings();
                const logoContainer = document.getElementById('logo-container');
                
                if (logoContainer && settings.logo) {
                    logoContainer.innerHTML = `<img src="${settings.logo}" alt="${settings.companyName}" class="logo-img">`;
                }
            }
            
            // ============ تحديث معلومات الفوتر ============
            updateFooterInfo() {
                const settings = this.dataManager.getSettings();
                
                const companyNameElements = document.querySelectorAll('.company-name, .footer-company-name');
                companyNameElements.forEach(el => {
                    if (el) el.textContent = settings.companyName || "الميثالي للتجارة";
                });
                
                const phoneElement = document.getElementById('footer-phone');
                const whatsappElement = document.getElementById('footer-whatsapp');
                const addressElement = document.getElementById('footer-address');
                
                if (phoneElement) phoneElement.textContent = settings.phone || "775555590";
                if (whatsappElement) whatsappElement.textContent = settings.whatsapp || "967775555590";
                if (addressElement) addressElement.textContent = settings.address || "صنعاء، اليمن";
            }
            
            // ============ واجهة العملاء ============
            loadCustomerPage(page) {
                this.currentPage = page;
                const contentArea = document.getElementById('customer-content');
                
                if (!contentArea) return;
                
                contentArea.innerHTML = this.getLoadingHTML();
                
                setTimeout(() => {
                    switch(page) {
                        case 'home':
                            contentArea.innerHTML = this.getCustomerHomeContent();
                            break;
                        case 'products':
                            contentArea.innerHTML = this.getCustomerProductsContent();
                            this.renderCustomerProducts();
                            break;
                        case 'about':
                            contentArea.innerHTML = this.getCustomerAboutContent();
                            break;
                        case 'contact':
                            contentArea.innerHTML = this.getCustomerContactContent();
                            break;
                    }
                    
                    contentArea.classList.add('fade-in');
                    this.closeMobileMenu();
                }, 300);
            }
            
            getLoadingHTML() {
                return `
                    <div class="flex justify-center items-center h-64">
                        <div class="spinner"></div>
                    </div>
                `;
            }
            
            getCustomerHomeContent() {
                const products = this.dataManager.getProducts().slice(0, 3);
                const settings = this.dataManager.getSettings();
                
                return `
                    <div class="fade-in">
                        <!-- Hero Section -->
                        <div class="relative rounded-2xl overflow-hidden mb-8">
                            <div class="absolute inset-0 bg-gradient-to-r from-green-900/90 to-green-700/90 z-10"></div>
                            <div class="relative z-20 p-8 md:p-12">
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                                    <div>
                                        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">${settings.companyName || "الميثالي للتجارة"}</h2>
                                        <p class="text-white/90 mb-6 text-lg">نوفر لكم أجود أنواع الحراثات والقطع الزراعية الأصلية بأسعار تنافسية وضمان على المنتجات.</p>
                                        <div class="flex flex-wrap gap-4">
                                            <button onclick="app.loadCustomerPage('products')" class="px-6 py-3 bg-white text-green-700 font-bold rounded-lg hover:bg-gray-100">
                                                تصفح المنتجات
                                            </button>
                                            <button onclick="app.showQuickOrder()" class="px-6 py-3 bg-transparent border-2 border-white text-white rounded-lg hover:bg-white/10">
                                                طلب سريع
                                            </button>
                                        </div>
                                    </div>
                                    <div class="hidden lg:block">
                                        <img src="https://images.unsplash.com/photo-1577471488278-16eec37ffcc2" alt="حراثة" class="w-full rounded-2xl shadow-2xl">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Featured Products -->
                        <div class="mb-12">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-2xl font-bold text-gray-800">منتجات مميزة</h3>
                                <button onclick="app.loadCustomerPage('products')" class="text-green-600 hover:text-green-800 font-bold">
                                    عرض الكل <i class="fas fa-arrow-left ml-1"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                ${products.map(product => `
                                    <div class="card product-card fade-in">
                                        ${product.stock < product.minStock ? `
                                            <div class="product-badge">كمية محدودة</div>
                                        ` : ''}
                                        <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-t-2xl">
                                        <div class="p-4">
                                            <h4 class="font-bold text-gray-800 text-lg mb-2">${product.name}</h4>
                                            <p class="text-gray-600 text-sm mb-3">${product.description.substring(0, 80)}...</p>
                                            <div class="flex justify-between items-center">
                                                <span class="text-green-700 font-bold">${this.dataManager.formatCurrency(product.price)}</span>
                                                <button onclick="app.addToCart(${product.id})" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                                    <i class="fas fa-cart-plus ml-2"></i>
                                                    أضف للسلة
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            getCustomerProductsContent() {
                const categories = this.dataManager.getCategories();
                
                return `
                    <div class="fade-in">
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">جميع المنتجات</h2>
                            <div class="flex flex-wrap gap-4 mb-6" id="category-filters">
                                <button onclick="app.filterProducts('all')" class="px-4 py-2 bg-green-600 text-white rounded-lg">الكل</button>
                                ${categories.map(category => `
                                    <button onclick="app.filterProducts('${category.name}')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">${category.name}</button>
                                `).join('')}
                            </div>
                            <div class="relative">
                                <input type="text" id="product-search" placeholder="ابحث عن منتج..." class="w-full md:w-96 px-4 py-2 border border-gray-300 rounded-lg pr-12" onkeyup="app.searchProducts(this.value)">
                                <i class="fas fa-search absolute right-4 top-3 text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div id="products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- سيتم تحميل المنتجات هنا -->
                        </div>
                        
                        <div id="products-loading" class="text-center py-12">
                            <div class="spinner mx-auto mb-4"></div>
                            <p class="text-gray-600">جاري تحميل المنتجات...</p>
                        </div>
                    </div>
                `;
            }
            
            renderCustomerProducts(filter = 'all', searchTerm = '') {
                const container = document.getElementById('products-container');
                const loading = document.getElementById('products-loading');
                const products = this.dataManager.getProducts();
                
                if (!container) return;
                
                let filteredProducts = products;
                
                if (filter !== 'all') {
                    filteredProducts = products.filter(p => p.category === filter);
                }
                
                if (searchTerm) {
                    const term = searchTerm.toLowerCase();
                    filteredProducts = filteredProducts.filter(p => 
                        p.name.toLowerCase().includes(term) || 
                        p.description.toLowerCase().includes(term)
                    );
                }
                
                if (filteredProducts.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-box-open text-5xl text-gray-300 mb-4"></i>
                            <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات</h3>
                            <p class="text-gray-600">لم يتم العثور على منتجات تطابق معايير البحث</p>
                        </div>
                    `;
                } else {
                    container.innerHTML = filteredProducts.map(product => `
                        <div class="card product-card fade-in">
                            ${product.stock < product.minStock ? `
                                <div class="product-badge">كمية محدودة</div>
                            ` : ''}
                            <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-t-2xl">
                            <div class="p-4">
                                <h4 class="font-bold text-gray-800 text-lg mb-2">${product.name}</h4>
                                <p class="text-gray-600 text-sm mb-3">${product.description.substring(0, 100)}...</p>
                                
                                <div class="mb-4">
                                    <p class="text-sm font-bold text-gray-700 mb-1">المميزات:</p>
                                    <div class="flex flex-wrap gap-1">
                                        ${product.features.slice(0, 3).map(feature => `
                                            <span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">${feature}</span>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="text-green-700 font-bold text-xl">${this.dataManager.formatCurrency(product.price)}</p>
                                        <p class="text-xs text-gray-500">المخزون: ${product.stock}</p>
                                    </div>
                                    <div class="flex gap-2">
                                        <button onclick="app.viewProduct(${product.id})" class="px-3 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button onclick="app.addToCart(${product.id})" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                            <i class="fas fa-cart-plus ml-2"></i>
                                            شراء
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
                
                if (loading) {
                    loading.style.display = 'none';
                }
            }
            
            filterProducts(category) {
                this.renderCustomerProducts(category);
            }
            
            searchProducts(term) {
                this.renderCustomerProducts('all', term);
            }
            
            getCustomerAboutContent() {
                const settings = this.dataManager.getSettings();
                const categories = this.dataManager.getCategories();
                
                return `
                    <div class="fade-in">
                        <!-- معلومات المؤسس -->
                        <div class="card p-8 mb-8">
                            <div class="flex flex-col lg:flex-row items-center gap-8 mb-8">
                                <div class="text-center lg:text-right lg:w-1/3">
                                    <img src="${settings.founderImage || 'https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                                         alt="${settings.founderName || 'المؤسس'}" 
                                         class="founder-img mx-auto lg:mx-0">
                                </div>
                                <div class="lg:w-2/3">
                                    <h2 class="text-2xl font-bold text-gray-800 mb-2">${settings.founderName || 'محمد الميثالي'}</h2>
                                    <p class="text-green-600 font-bold mb-4">${settings.founderPosition || 'المؤسس والرئيس التنفيذي'}</p>
                                    <p class="text-gray-600 leading-relaxed mb-4">
                                        ${settings.founderBio || 'مؤسس شركة الميثالي للتجارة بخبرة تزيد عن 30 عاماً في مجال المعدات الزراعية. قاد الشركة لتكون الرائدة في اليمن في مجال تجارة الجرارات والقطع الزراعية.'}
                                    </p>
                                    <div class="flex flex-wrap gap-4 mt-6">
                                        <div class="flex items-center text-gray-600">
                                            <i class="fas fa-award text-green-600 ml-2"></i>
                                            <span>خبرة 30+ سنة</span>
                                        </div>
                                        <div class="flex items-center text-gray-600">
                                            <i class="fas fa-handshake text-green-600 ml-2"></i>
                                            <span>ثقة العملاء</span>
                                        </div>
                                        <div class="flex items-center text-gray-600">
                                            <i class="fas fa-star text-green-600 ml-2"></i>
                                            <span>جودة عالمية</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- معلومات الشركة -->
                            <div class="border-t pt-8">
                                <h3 class="text-xl font-bold text-gray-800 mb-6">معلومات حولنا</h3>
                                <div class="prose max-w-none">
                                    <p class="text-gray-600 leading-relaxed mb-6">
                                        تأسست شركة ${settings.companyName || "الميثالي للتجارة"} عام 1995 كشركة رائدة في مجال تجارة المعدات الزراعية والحراثات في اليمن. على مدار أكثر من ربع قرن، كنا جزءاً من النمو الزراعي في البلاد، حيث وفرنا للمزارعين اليمنيين أحدث المعدات والحراثات ذات الجودة العالية.
                                    </p>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                        <div class="text-center p-4 bg-green-50 rounded-xl fade-in">
                                            <i class="fas fa-bullseye text-3xl text-green-600 mb-4"></i>
                                            <h4 class="font-bold text-gray-800 mb-2">رؤيتنا</h4>
                                            <p class="text-gray-600">أن نكون الشركة الرائدة في توريد المعدات الزراعية في اليمن والمنطقة.</p>
                                        </div>
                                        
                                        <div class="text-center p-4 bg-blue-50 rounded-xl fade-in">
                                            <i class="fas fa-handshake text-3xl text-blue-600 mb-4"></i>
                                            <h4 class="font-bold text-gray-800 mb-2">رسالتنا</h4>
                                            <p class="text-gray-600">توفير حلول زراعية متكاملة تساهم في تنمية القطاع الزراعي اليمني.</p>
                                        </div>
                                        
                                        <div class="text-center p-4 bg-orange-50 rounded-xl fade-in">
                                            <i class="fas fa-star text-3xl text-orange-600 mb-4"></i>
                                            <h4 class="font-bold text-gray-800 mb-2">قيمنا</h4>
                                            <p class="text-gray-600">الجودة، المصداقية، الابتكار، وخدمة العملاء.</p>
                                        </div>
                                    </div>
                                    
                                    <!-- الأصناف المتاحة -->
                                    <div class="mb-8">
                                        <h4 class="text-lg font-bold text-gray-800 mb-4">أصنافنا المتاحة</h4>
                                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                            ${categories.map(category => `
                                                <div class="bg-gray-50 p-3 rounded-lg text-center">
                                                    <i class="fas fa-tag text-green-600 mb-2"></i>
                                                    <p class="font-medium text-gray-800">${category.name}</p>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                    
                                    <div class="bg-yellow-50 p-6 rounded-xl">
                                        <h4 class="font-bold text-yellow-800 mb-2">حقائق وأرقام</h4>
                                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                            <div class="text-center">
                                                <p class="text-2xl font-bold text-yellow-700">30+</p>
                                                <p class="text-sm text-yellow-600">سنة خبرة</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="text-2xl font-bold text-yellow-700">5000+</p>
                                                <p class="text-sm text-yellow-600">عميل راضٍ</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="text-2xl font-bold text-yellow-700">100+</p>
                                                <p class="text-sm text-yellow-600">منتج متوفر</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="text-2xl font-bold text-yellow-700">24/7</p>
                                                <p class="text-sm text-yellow-600">دعم فني</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            getCustomerContactContent() {
                const settings = this.dataManager.getSettings();
                
                return `
                    <div class="fade-in">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- معلومات الاتصال -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-6">معلومات الاتصال</h3>
                                <div class="space-y-6">
                                    <div class="flex items-center p-4 bg-green-50 rounded-xl fade-in">
                                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600 ml-4">
                                            <i class="fas fa-phone-alt"></i>
                                        </div>
                                        <div>
                                            <p class="font-bold text-slate-800">الهاتف</p>
                                            <p class="text-slate-600">${settings.phone || "775555590"}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center p-4 bg-blue-50 rounded-xl fade-in">
                                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 ml-4">
                                            <i class="fab fa-whatsapp"></i>
                                        </div>
                                        <div>
                                            <p class="font-bold text-slate-800">الواتساب</p>
                                            <p class="text-slate-600">${settings.whatsapp || "967775555590"}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center p-4 bg-gray-50 rounded-xl fade-in">
                                        <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 ml-4">
                                            <i class="fas fa-map-marker-alt"></i>
                                        </div>
                                        <div>
                                            <p class="font-bold text-slate-800">العنوان</p>
                                            <p class="text-slate-600">${settings.address || "صنعاء، اليمن"}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="p-4 bg-yellow-50 rounded-xl fade-in">
                                        <h4 class="font-bold text-yellow-800 mb-2">ساعات العمل</h4>
                                        <div class="space-y-2">
                                            <div class="flex justify-between">
                                                <span class="text-yellow-700">السبت - الخميس</span>
                                                <span class="font-bold">8:00 ص - 10:00 م</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-yellow-700">الجمعة</span>
                                                <span class="font-bold">4:00 م - 10:00 م</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- نموذج الاتصال -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-6">إرسال رسالة</h3>
                                <form id="contact-form" onsubmit="event.preventDefault(); app.submitContactForm(event)">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-gray-700 mb-2">الاسم الكامل</label>
                                            <input type="text" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">رقم الهاتف</label>
                                            <input type="tel" name="phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">نوع الاستفسار</label>
                                            <select name="type" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                                <option value="استفسار">استفسار عام</option>
                                                <option value="منتج">استفسار عن منتج</option>
                                                <option value="سعر">طلب سعر</option>
                                                <option value="دعم">دعم فني</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">الرسالة</label>
                                            <textarea name="message" rows="4" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                                        </div>
                                        
                                        <button type="submit" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                            <i class="fas fa-paper-plane ml-2"></i> إرسال الرسالة
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // ============ واجهة المدير ============
            loadAdminPage(page) {
                const contentArea = document.getElementById('admin-content');
                const title = document.getElementById('admin-page-title');
                
                if (!contentArea) return;
                
                contentArea.innerHTML = this.getLoadingHTML();
                
                setTimeout(() => {
                    switch(page) {
                        case 'dashboard':
                            contentArea.innerHTML = this.getAdminDashboardContent();
                            title.textContent = 'لوحة التحكم';
                            break;
                        case 'products':
                            contentArea.innerHTML = this.getAdminProductsContent();
                            title.textContent = 'إدارة المنتجات';
                            this.renderAdminProducts();
                            break;
                        case 'categories':
                            contentArea.innerHTML = this.getAdminCategoriesContent();
                            title.textContent = 'إدارة الأصناف';
                            this.renderAdminCategories();
                            break;
                        case 'currencies':
                            contentArea.innerHTML = this.getAdminCurrenciesContent();
                            title.textContent = 'إدارة العملات';
                            this.renderAdminCurrencies();
                            break;
                        case 'orders':
                            contentArea.innerHTML = this.getAdminOrdersContent();
                            title.textContent = 'إدارة الطلبات';
                            this.renderAdminOrders();
                            break;
                        case 'customers':
                            contentArea.innerHTML = this.getAdminCustomersContent();
                            title.textContent = 'إدارة العملاء';
                            this.renderAdminCustomers();
                            break;
                        case 'messages':
                            contentArea.innerHTML = this.getAdminMessagesContent();
                            title.textContent = 'الرسائل';
                            this.renderAdminMessages();
                            break;
                        case 'fileManagement':
                            contentArea.innerHTML = this.getAdminFileManagementContent();
                            title.textContent = 'إدارة الملفات';
                            break;
                        case 'settings':
                            contentArea.innerHTML = this.getAdminSettingsContent();
                            title.textContent = 'الإعدادات';
                            break;
                    }
                    
                    contentArea.classList.add('fade-in');
                    this.updateActiveNav(page);
                }, 300);
            }
            
            updateActiveNav(page) {
                const navItems = document.querySelectorAll('.admin-nav-item');
                navItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.textContent.includes(this.getPageTitle(page))) {
                        item.classList.add('active');
                    }
                });
            }
            
            getPageTitle(page) {
                const titles = {
                    'dashboard': 'لوحة التحكم',
                    'products': 'المنتجات',
                    'categories': 'الأصناف',
                    'currencies': 'العملات',
                    'orders': 'الطلبات',
                    'customers': 'العملاء',
                    'messages': 'الرسائل',
                    'fileManagement': 'إدارة الملفات',
                    'settings': 'الإعدادات'
                };
                return titles[page] || page;
            }
            
            getAdminDashboardContent() {
                const stats = this.dataManager.calculateOrderStats();
                const products = this.dataManager.getProducts();
                const lowStock = products.filter(p => p.stock < p.minStock).length;
                const messages = this.dataManager.getMessages();
                const unreadMessages = messages.filter(m => !m.read).length;
                
                return `
                    <div class="fade-in">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="card p-6 fade-in">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center text-white text-xl ml-4">
                                        <i class="fas fa-shopping-cart"></i>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-sm">إجمالي الطلبات</p>
                                        <p class="text-2xl font-bold text-gray-800">${stats.total}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6 fade-in">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-yellow-700 rounded-xl flex items-center justify-center text-white text-xl ml-4">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-sm">طلبات معلقة</p>
                                        <p class="text-2xl font-bold text-gray-800">${stats.pending}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6 fade-in">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-700 rounded-xl flex items-center justify-center text-white text-xl ml-4">
                                        <i class="fas fa-box"></i>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-sm">منتجات منخفضة المخزون</p>
                                        <p class="text-2xl font-bold text-gray-800">${lowStock}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6 fade-in">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-700 rounded-xl flex items-center justify-center text-white text-xl ml-4">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-sm">رسائل غير مقروءة</p>
                                        <p class="text-2xl font-bold text-gray-800">${unreadMessages}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- الطلبات الأخيرة -->
                            <div class="card p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-bold text-gray-800">آخر الطلبات</h3>
                                    <a href="#" onclick="app.loadAdminPage('orders')" class="text-sm text-green-600 hover:text-green-800">عرض الكل</a>
                                </div>
                                <div id="recent-orders">
                                    ${this.getRecentOrdersHTML()}
                                </div>
                            </div>
                            
                            <!-- المنتجات الأكثر طلباً -->
                            <div class="card p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-bold text-gray-800">المنتجات الأكثر طلباً</h3>
                                    <a href="#" onclick="app.loadAdminPage('products')" class="text-sm text-green-600 hover:text-green-800">عرض الكل</a>
                                </div>
                                <div id="popular-products">
                                    ${this.getPopularProductsHTML()}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            getRecentOrdersHTML() {
                const orders = this.dataManager.getOrders();
                const recentOrders = orders.slice(0, 5);
                
                if (recentOrders.length === 0) {
                    return `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-shopping-cart text-3xl mb-3"></i>
                            <p>لا توجد طلبات</p>
                        </div>
                    `;
                }
                
                return recentOrders.map(order => `
                    <div class="flex items-center justify-between p-3 border-b hover:bg-gray-50 cursor-pointer" onclick="app.viewAdminOrder(${order.id})">
                        <div>
                            <p class="font-bold text-gray-800">طلب #${order.id}</p>
                            <p class="text-sm text-gray-600">${order.customerName || 'عميل جديد'}</p>
                        </div>
                        <div class="text-left">
                            <p class="font-bold text-green-700">${this.dataManager.formatCurrency(order.total || 0)}</p>
                            <span class="text-xs px-2 py-1 rounded-full ${this.dataManager.getStatusClass(order.status)}">${order.status}</span>
                        </div>
                    </div>
                `).join('');
            }
            
            getPopularProductsHTML() {
                const products = this.dataManager.getProducts();
                const popularProducts = products.slice(0, 5);
                
                return popularProducts.map(product => `
                    <div class="flex items-center p-3 border-b hover:bg-gray-50">
                        <img src="${product.image}" alt="${product.name}" class="w-10 h-10 object-cover rounded-lg ml-3">
                        <div class="flex-1">
                            <p class="font-bold text-gray-800">${product.name}</p>
                            <p class="text-sm text-gray-600">${this.dataManager.formatCurrency(product.price)}</p>
                        </div>
                        <div class="text-left">
                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">${Math.floor(Math.random() * 20) + 5} مبيع</span>
                        </div>
                    </div>
                `).join('');
            }
            
            // ============ إدارة المنتجات ============
            getAdminProductsContent() {
                const categories = this.dataManager.getCategories();
                
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة المنتجات</h2>
                                <p class="text-gray-600">إضافة وتعديل وحذف منتجات المتجر</p>
                            </div>
                            <button onclick="app.showProductModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center">
                                <i class="fas fa-plus ml-2"></i>
                                إضافة منتج جديد
                            </button>
                        </div>
                        
                        <div class="card overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الصورة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">اسم المنتج</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الصنف</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">السعر</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">المخزون</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراءات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="admin-products-table" class="bg-white divide-y divide-gray-200">
                                        <!-- سيتم تحميل المنتجات هنا -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderAdminProducts() {
                const container = document.getElementById('admin-products-table');
                const products = this.dataManager.getProducts();
                
                if (!container) return;
                
                if (products.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-6 py-12 text-center">
                                <i class="fas fa-box-open text-5xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات</h3>
                                <p class="text-gray-600">لم تقم بإضافة أي منتجات بعد</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                container.innerHTML = products.map(product => `
                    <tr class="fade-in">
                        <td class="px-6 py-4">
                            <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-lg">
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${product.name}</div>
                            <div class="text-sm text-gray-500">${product.description.substring(0, 50)}...</div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">${product.category}</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">${this.dataManager.formatCurrency(product.price)}</td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium ${product.stock < product.minStock ? 'text-red-600' : 'text-gray-900'}">${product.stock}</div>
                            <div class="text-xs text-gray-500">الحد الأدنى: ${product.minStock}</div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs rounded-full ${product.status === 'متوفر' ? 'bg-green-100 text-green-800' : product.status === 'كمية محدودة' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">
                                ${product.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <button onclick="app.editProduct(${product.id})" class="text-blue-600 hover:text-blue-900 ml-4">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="app.deleteProduct(${product.id})" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // ============ إدارة الأصناف ============
            getAdminCategoriesContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة الأصناف</h2>
                                <p class="text-gray-600">إضافة وتعديل وحذف أصناف المنتجات</p>
                            </div>
                            <button onclick="app.showCategoryModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center">
                                <i class="fas fa-plus ml-2"></i>
                                إضافة صنف جديد
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="admin-categories-container">
                            <!-- سيتم تحميل الأصناف هنا -->
                        </div>
                    </div>
                `;
            }
            
            renderAdminCategories() {
                const container = document.getElementById('admin-categories-container');
                const categories = this.dataManager.getCategories();
                
                if (!container) return;
                
                if (categories.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-tags text-5xl text-gray-300 mb-4"></i>
                            <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد أصناف</h3>
                            <p class="text-gray-600">لم تقم بإضافة أي أصناف بعد</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = categories.map(category => `
                    <div class="card fade-in">
                        <img src="${category.image}" alt="${category.name}" class="w-full h-48 object-cover rounded-t-2xl">
                        <div class="p-4">
                            <h4 class="font-bold text-gray-800 text-lg mb-2">${category.name}</h4>
                            <p class="text-gray-600 text-sm mb-4">${category.description}</p>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">
                                    ${this.dataManager.getProducts().filter(p => p.category === category.name).length} منتج
                                </span>
                                <div class="flex gap-2">
                                    <button onclick="app.editCategory(${category.id})" class="px-3 py-1 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="app.deleteCategory(${category.id})" class="px-3 py-1 bg-red-100 text-red-600 rounded-lg hover:bg-red-200">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // ============ إدارة العملات ============
            getAdminCurrenciesContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة العملات</h2>
                                <p class="text-gray-600">إضافة وتعديل وحذف العملات المتاحة</p>
                            </div>
                            <button onclick="app.showCurrencyModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center">
                                <i class="fas fa-plus ml-2"></i>
                                إضافة عملة جديدة
                            </button>
                        </div>
                        
                        <div class="card overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العملة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الرمز</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">سعر الصرف</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراءات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="admin-currencies-table" class="bg-white divide-y divide-gray-200">
                                        <!-- سيتم تحميل العملات هنا -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderAdminCurrencies() {
                const container = document.getElementById('admin-currencies-table');
                const currencies = this.dataManager.getCurrencies();
                
                if (!container) return;
                
                if (currencies.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-6 py-12 text-center">
                                <i class="fas fa-money-bill-wave text-5xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد عملات</h3>
                                <p class="text-gray-600">لم تقم بإضافة أي عملات بعد</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                container.innerHTML = currencies.map(currency => `
                    <tr class="fade-in">
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${currency.code}</div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${currency.symbol}</div>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">
                            ${currency.rate === 1 ? 'العملة الأساسية' : `1 ${currency.code} = ${currency.rate} ر.ي`}
                        </td>
                        <td class="px-6 py-4">
                            ${currency.isDefault ? `
                                <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">افتراضية</span>
                            ` : ''}
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            ${!currency.isDefault ? `
                                <button onclick="app.setDefaultCurrency(${currency.id})" class="text-green-600 hover:text-green-900 ml-4">
                                    <i class="fas fa-check-circle"></i>
                                </button>
                            ` : ''}
                            <button onclick="app.editCurrency(${currency.id})" class="text-blue-600 hover:text-blue-900 ml-4">
                                <i class="fas fa-edit"></i>
                            </button>
                            ${!currency.isDefault ? `
                                <button onclick="app.deleteCurrency(${currency.id})" class="text-red-600 hover:text-red-900">
                                    <i class="fas fa-trash"></i>
                                </button>
                            ` : ''}
                        </td>
                    </tr>
                `).join('');
            }
            
            // ============ وظائف المساعدة ============
            updateCartCount() {
                const cart = this.dataManager.getCart();
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                const badge = document.getElementById('cart-count');
                
                if (badge) {
                    if (totalItems > 0) {
                        badge.textContent = totalItems > 99 ? '99+' : totalItems;
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }
                }
            }
            
            updateDateTime() {
                const now = new Date();
                const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const timeOptions = { hour: '2-digit', minute: '2-digit' };
                
                const dateStr = now.toLocaleDateString('ar-YE', dateOptions);
                const timeStr = now.toLocaleTimeString('ar-YE', timeOptions);
                
                const dateElement = document.getElementById('admin-date');
                if (dateElement) {
                    dateElement.textContent = `${dateStr} - ${timeStr}`;
                }
            }
            
            updateAdminStats() {
                const stats = this.dataManager.calculateOrderStats();
                const messages = this.dataManager.getMessages();
                const unreadMessages = messages.filter(m => !m.read).length;
                const unreadNotifications = this.dataManager.getUnreadNotificationsCount();
                
                const ordersBadge = document.getElementById('admin-orders-count');
                const messagesBadge = document.getElementById('admin-messages-count');
                const notificationsBadge = document.getElementById('notification-badge');
                
                if (ordersBadge) {
                    if (stats.pending > 0) {
                        ordersBadge.textContent = stats.pending;
                        ordersBadge.classList.remove('hidden');
                    } else {
                        ordersBadge.classList.add('hidden');
                    }
                }
                
                if (messagesBadge) {
                    if (unreadMessages > 0) {
                        messagesBadge.textContent = unreadMessages;
                        messagesBadge.classList.remove('hidden');
                    } else {
                        messagesBadge.classList.add('hidden');
                    }
                }
                
                if (notificationsBadge) {
                    if (unreadNotifications > 0) {
                        notificationsBadge.textContent = unreadNotifications;
                        notificationsBadge.classList.remove('hidden');
                    } else {
                        notificationsBadge.classList.add('hidden');
                    }
                }
            }
            
            toggleMobileMenu() {
                const menu = document.getElementById('mobile-menu');
                const overlay = document.getElementById('overlay');
                
                if (menu && overlay) {
                    menu.classList.toggle('open');
                    overlay.classList.toggle('active');
                }
            }
            
            closeMobileMenu() {
                const menu = document.getElementById('mobile-menu');
                const overlay = document.getElementById('overlay');
                
                if (menu && overlay) {
                    menu.classList.remove('open');
                    overlay.classList.remove('active');
                }
            }
            
            closeModal() {
                const modal = document.querySelector('.modal.active');
                const overlay = document.getElementById('overlay');
                
                if (modal) {
                    modal.classList.remove('active');
                }
                if (overlay) {
                    overlay.classList.remove('active');
                }
            }
            
            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle text-green-500' : type === 'error' ? 'times-circle text-red-500' : 'info-circle text-blue-500'}"></i>
                    <span>${message}</span>
                `;
                
                const container = document.getElementById('toast-container');
                container.appendChild(toast);
                
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }
            
            // ============ وظائف السلة ============
            showCart() {
                const cart = this.dataManager.getCart();
                const products = this.dataManager.getProducts();
                
                if (cart.length === 0) {
                    this.showToast('سلة المشتريات فارغة', 'info');
                    return;
                }
                
                let total = 0;
                let itemsHtml = '';
                
                cart.forEach(item => {
                    const product = products.find(p => p.id === item.productId);
                    if (product) {
                        const itemTotal = product.price * item.quantity;
                        total += itemTotal;
                        
                        itemsHtml += `
                            <div class="flex items-center justify-between p-4 border-b">
                                <div class="flex items-center">
                                    <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-lg ml-4">
                                    <div>
                                        <h4 class="font-bold text-gray-800">${product.name}</h4>
                                        <p class="text-sm text-gray-600">${this.dataManager.formatCurrency(product.price)}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <button onclick="app.updateCartItemQuantity(${product.id}, ${item.quantity - 1})" class="w-8 h-8 flex items-center justify-center border rounded-lg" ${item.quantity <= 1 ? 'disabled' : ''}>
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <span class="mx-3 font-bold">${item.quantity}</span>
                                    <button onclick="app.updateCartItemQuantity(${product.id}, ${item.quantity + 1})" class="w-8 h-8 flex items-center justify-center border rounded-lg">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                    <button onclick="app.removeFromCart(${product.id})" class="text-red-600 hover:text-red-800 mr-4">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    }
                });
                
                const modal = document.createElement('div');
                modal.className = 'modal w-11/12 md:w-2/3 lg:w-1/2';
                modal.innerHTML = `
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">سلة المشتريات</h3>
                            <button onclick="app.closeModal()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="max-h-96 overflow-y-auto mb-6 custom-scrollbar">
                            ${itemsHtml}
                        </div>
                        
                        <div class="border-t pt-6">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-lg font-bold text-gray-800">الإجمالي</span>
                                <span class="text-2xl font-bold text-green-700">${this.dataManager.formatCurrency(total)}</span>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <button onclick="app.clearCart()" class="px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">
                                    تفريغ السلة
                                </button>
                                <button onclick="app.checkout()" class="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                    إتمام الطلب
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.classList.add('active');
                document.getElementById('overlay').classList.add('active');
            }
            
            addToCart(productId) {
                let cart = this.dataManager.getCart();
                const product = this.dataManager.getProduct(productId);
                
                if (!product) return;
                
                const existingItem = cart.find(item => item.productId === productId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        productId: productId,
                        quantity: 1,
                        addedAt: new Date().toISOString()
                    });
                }
                
                this.dataManager.saveCart(cart);
                this.updateCartCount();
                this.showToast('تمت إضافة المنتج إلى السلة');
            }
            
            updateCartItemQuantity(productId, quantity) {
                if (quantity < 1) {
                    this.removeFromCart(productId);
                    return;
                }
                
                let cart = this.dataManager.getCart();
                const item = cart.find(item => item.productId === productId);
                
                if (item) {
                    item.quantity = quantity;
                    this.dataManager.saveCart(cart);
                    this.showCart();
                    this.updateCartCount();
                }
            }
            
            removeFromCart(productId) {
                let cart = this.dataManager.getCart();
                cart = cart.filter(item => item.productId !== productId);
                this.dataManager.saveCart(cart);
                this.showCart();
                this.updateCartCount();
                this.showToast('تمت إزالة المنتج من السلة');
            }
            
            clearCart() {
                this.dataManager.clearCart();
                this.showCart();
                this.updateCartCount();
                this.showToast('تم تفريغ السلة');
            }
            
            checkout() {
                this.showCheckoutModal();
            }
            
            showCheckoutModal() {
                const cart = this.dataManager.getCart();
                const products = this.dataManager.getProducts();
                
                if (cart.length === 0) {
                    this.showToast('السلة فارغة', 'error');
                    return;
                }
                
                let total = 0;
                cart.forEach(item => {
                    const product = products.find(p => p.id === item.productId);
                    if (product) {
                        total += product.price * item.quantity;
                    }
                });
                
                const modal = document.createElement('div');
                modal.className = 'modal w-11/12 md:w-2/3 lg:w-1/2';
                modal.innerHTML = `
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">إتمام الطلب</h3>
                            <button onclick="app.closeModal()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form id="checkout-form" onsubmit="event.preventDefault(); app.submitOrder(event)">
                            <div class="space-y-4 mb-6">
                                <div>
                                    <label class="block text-gray-700 mb-2">الاسم الكامل *</label>
                                    <input type="text" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-gray-700 mb-2">رقم الهاتف *</label>
                                        <input type="tel" name="phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 mb-2">المدينة</label>
                                        <input type="text" name="city" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">عنوان التوصيل</label>
                                    <textarea name="address" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">ملاحظات إضافية</label>
                                    <textarea name="notes" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
                                </div>
                                
                                <div class="p-4 bg-gray-50 rounded-lg">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-gray-700">إجمالي الطلب:</span>
                                        <span class="text-xl font-bold text-green-700">${this.dataManager.formatCurrency(total)}</span>
                                    </div>
                                    <p class="text-sm text-gray-600">سيتم التواصل معك خلال 24 ساعة لتأكيد الطلب</p>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <button type="button" onclick="app.closeModal()" class="px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">
                                    إلغاء
                                </button>
                                <button type="button" onclick="app.sendOrderViaWhatsApp()" class="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                    <i class="fab fa-whatsapp ml-2"></i>
                                    إرسال عبر واتساب
                                </button>
                                <button type="submit" class="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                    <i class="fas fa-check ml-2"></i>
                                    تأكيد الطلب
                                </button>
                            </div>
                        </form>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.classList.add('active');
                document.getElementById('overlay').classList.add('active');
            }
            
            submitOrder(event) {
                const formData = new FormData(event.target);
                const cart = this.dataManager.getCart();
                const products = this.dataManager.getProducts();
                
                let total = 0;
                const items = [];
                
                cart.forEach(cartItem => {
                    const product = products.find(p => p.id === cartItem.productId);
                    if (product) {
                        total += product.price * cartItem.quantity;
                        items.push({
                            productId: product.id,
                            name: product.name,
                            price: product.price,
                            quantity: cartItem.quantity,
                            total: product.price * cartItem.quantity
                        });
                    }
                });
                
                const order = {
                    customerName: formData.get('name'),
                    customerPhone: formData.get('phone'),
                    customerCity: formData.get('city'),
                    customerAddress: formData.get('address'),
                    notes: formData.get('notes'),
                    items: items,
                    total: total,
                    status: 'معلق',
                    source: 'الموقع',
                    createdAt: new Date().toISOString()
                };
                
                this.dataManager.saveOrder(order);
                
                const customer = {
                    name: formData.get('name'),
                    phone: formData.get('phone'),
                    city: formData.get('city'),
                    address: formData.get('address'),
                    type: 'عميل',
                    lastOrder: new Date().toISOString()
                };
                
                this.dataManager.saveCustomer(customer);
                this.dataManager.clearCart();
                this.closeModal();
                
                this.showToast('تم استلام طلبك بنجاح! سنتواصل معك قريباً', 'success');
                this.updateCartCount();
                
                this.dataManager.addNotification('طلب جديد', `طلب جديد من ${order.customerName} بمبلغ ${this.dataManager.formatCurrency(total)}`);
            }
            
            sendOrderViaWhatsApp() {
                const form = document.getElementById('checkout-form');
                if (!form) return;
                
                const formData = new FormData(form);
                const cart = this.dataManager.getCart();
                const products = this.dataManager.getProducts();
                const settings = this.dataManager.getSettings();
                
                let message = `*طلب جديد من الموقع*\n\n`;
                message += `*الاسم:* ${formData.get('name')}\n`;
                message += `*الهاتف:* ${formData.get('phone')}\n`;
                message += `*المدينة:* ${formData.get('city') || 'غير محدد'}\n`;
                message += `*العنوان:* ${formData.get('address') || 'غير محدد'}\n\n`;
                message += `*المنتجات:*\n`;
                
                let total = 0;
                cart.forEach(cartItem => {
                    const product = products.find(p => p.id === cartItem.productId);
                    if (product) {
                        const itemTotal = product.price * cartItem.quantity;
                        total += itemTotal;
                        message += `- ${product.name} (${cartItem.quantity}) × ${this.dataManager.formatCurrency(product.price)} = ${this.dataManager.formatCurrency(itemTotal)}\n`;
                    }
                });
                
                message += `\n*الإجمالي:* ${this.dataManager.formatCurrency(total)}\n`;
                message += `*ملاحظات:* ${formData.get('notes') || 'لا توجد'}\n\n`;
                message += `*شكراً لاختياركم ${settings.companyName || "الميثالي للتجارة"}*`;
                
                const encodedMessage = encodeURIComponent(message);
                window.open(`https://wa.me/${settings.whatsapp}?text=${encodedMessage}`, '_blank');
            }
            
            // ============ وظائف إضافية ============
            showAdminLogin() {
                Swal.fire({
                    title: 'تسجيل دخول المدير',
                    input: 'password',
                    inputLabel: 'كلمة المرور',
                    inputPlaceholder: 'أدخل كلمة المرور',
                    showCancelButton: true,
                    confirmButtonText: 'دخول',
                    cancelButtonText: 'إلغاء',
                    preConfirm: (password) => {
                        if (!password) {
                            Swal.showValidationMessage('يرجى إدخال كلمة المرور');
                        } else if (!this.dataManager.checkAdminPassword(password)) {
                            Swal.showValidationMessage('كلمة المرور غير صحيحة');
                        }
                        return password;
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.renderAdminInterface();
                        this.showToast('تم تسجيل الدخول بنجاح');
                    }
                });
            }
            
            showQuickOrder() {
                this.showCheckoutModal();
            }
            
            showWhatsApp() {
                const settings = this.dataManager.getSettings();
                window.open(`https://wa.me/${settings.whatsapp}`, '_blank');
            }
            
            viewProduct(productId) {
                const product = this.dataManager.getProduct(productId);
                if (!product) return;
                
                Swal.fire({
                    title: product.name,
                    html: `
                        <div class="text-right">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-lg mb-4">
                            <p class="text-gray-600 mb-4">${product.description}</p>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <p class="text-sm text-gray-500">السعر</p>
                                    <p class="text-lg font-bold text-green-700">${this.dataManager.formatCurrency(product.price)}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">المخزون</p>
                                    <p class="text-lg font-bold ${product.stock < product.minStock ? 'text-red-600' : 'text-gray-800'}">${product.stock}</p>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p class="text-sm text-gray-500 mb-2">المميزات:</p>
                                <div class="flex flex-wrap gap-2">
                                    ${product.features?.map(f => `<span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">${f}</span>`).join('') || 'لا توجد مميزات'}
                                </div>
                            </div>
                        </div>
                    `,
                    showCloseButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'إضافة إلى السلة',
                    cancelButtonText: 'إغلاق'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.addToCart(productId);
                    }
                });
            }
            
            submitContactForm(event) {
                const formData = new FormData(event.target);
                const message = {
                    name: formData.get('name'),
                    phone: formData.get('phone'),
                    type: formData.get('type'),
                    message: formData.get('message')
                };
                
                this.dataManager.saveMessage(message);
                this.showToast('تم إرسال رسالتك بنجاح، وسنرد عليك قريباً');
                event.target.reset();
            }
            
            logout() {
                Swal.fire({
                    title: 'تسجيل الخروج',
                    text: 'هل أنت متأكد من رغبتك في تسجيل الخروج؟',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، سجل الخروج',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.renderCustomerInterface();
                        this.showToast('تم تسجيل الخروج بنجاح');
                    }
                });
            }
            
            // ============ وظائف إدارة المنتجات في المدير ============
            showProductModal(productId = null) {
                const product = productId ? this.dataManager.getProduct(productId) : null;
                const categories = this.dataManager.getCategories();
                
                Swal.fire({
                    title: product ? 'تعديل المنتج' : 'إضافة منتج جديد',
                    html: `
                        <form id="product-form" class="text-right space-y-4">
                            <input type="hidden" id="product-id" value="${product?.id || ''}">
                            
                            <div>
                                <label class="block text-gray-700 mb-2">اسم المنتج *</label>
                                <input type="text" id="product-name" value="${product?.name || ''}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">الوصف</label>
                                <textarea id="product-description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg">${product?.description || ''}</textarea>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">الصنف *</label>
                                    <select id="product-category" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                        ${categories.map(category => `
                                            <option value="${category.name}" ${product?.category === category.name ? 'selected' : ''}>${category.name}</option>
                                        `).join('')}
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">السعر (ريال) *</label>
                                    <input type="number" id="product-price" value="${product?.price || ''}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">المخزون *</label>
                                    <input type="number" id="product-stock" value="${product?.stock || '0'}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2">الحد الأدنى للمخزون</label>
                                    <input type="number" id="product-min-stock" value="${product?.minStock || '5'}" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">صورة المنتج (رابط أو رفع)</label>
                                <input type="url" id="product-image-url" value="${product?.image || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="https://example.com/image.jpg">
                                <input type="file" id="product-image-file" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg" onchange="app.handleProductImageUpload(this)">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">الحالة</label>
                                <select id="product-status" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                    <option value="متوفر" ${product?.status === 'متوفر' ? 'selected' : ''}>متوفر</option>
                                    <option value="كمية محدودة" ${product?.status === 'كمية محدودة' ? 'selected' : ''}>كمية محدودة</option>
                                    <option value="غير متوفر" ${product?.status === 'غير متوفر' ? 'selected' : ''}>غير متوفر</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">المميزات (افصل بينها بفاصلة)</label>
                                <input type="text" id="product-features" value="${product?.features?.join(', ') || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ميزة 1, ميزة 2, ميزة 3">
                            </div>
                        </form>
                    `,
                    showCancelButton: true,
                    confirmButtonText: product ? 'تحديث' : 'إضافة',
                    cancelButtonText: 'إلغاء',
                    preConfirm: async () => {
                        const id = document.getElementById('product-id').value;
                        const name = document.getElementById('product-name').value;
                        const description = document.getElementById('product-description').value;
                        const category = document.getElementById('product-category').value;
                        const price = document.getElementById('product-price').value;
                        const stock = document.getElementById('product-stock').value;
                        const minStock = document.getElementById('product-min-stock').value;
                        const imageUrl = document.getElementById('product-image-url').value;
                        const imageFile = document.getElementById('product-image-file').files[0];
                        const status = document.getElementById('product-status').value;
                        const features = document.getElementById('product-features').value;
                        
                        if (!name || !price || !stock) {
                            Swal.showValidationMessage('يرجى ملء جميع الحقول المطلوبة');
                            return false;
                        }
                        
                        let image = imageUrl;
                        
                        if (imageFile) {
                            try {
                                image = await this.dataManager.uploadImage(imageFile);
                            } catch (error) {
                                Swal.showValidationMessage('خطأ في رفع الصورة');
                                return false;
                            }
                        }
                        
                        return {
                            id: id ? parseInt(id) : undefined,
                            name,
                            description,
                            category,
                            price: parseInt(price),
                            stock: parseInt(stock),
                            minStock: parseInt(minStock) || 5,
                            image: image || 'https://images.unsplash.com/photo-1577471488278-16eec37ffcc2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                            status,
                            features: features ? features.split(',').map(f => f.trim()).filter(f => f) : []
                        };
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        const productData = result.value;
                        this.dataManager.saveProduct(productData);
                        this.showToast(productData.id ? 'تم تحديث المنتج' : 'تم إضافة المنتج');
                        this.renderAdminProducts();
                    }
                });
            }
            
            handleProductImageUpload(input) {
                const urlInput = document.getElementById('product-image-url');
                if (input.files && input.files[0]) {
                    urlInput.value = '';
                }
            }
            
            editProduct(productId) {
                this.showProductModal(productId);
            }
            
            deleteProduct(productId) {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم حذف المنتج نهائياً',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، احذف',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#ef4444'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.dataManager.deleteProduct(productId);
                        this.showToast('تم حذف المنتج');
                        this.renderAdminProducts();
                    }
                });
            }
            
            // ============ وظائف إدارة الأصناف ============
            showCategoryModal(categoryId = null) {
                const category = categoryId ? this.dataManager.getCategory(categoryId) : null;
                
                Swal.fire({
                    title: category ? 'تعديل الصنف' : 'إضافة صنف جديد',
                    html: `
                        <form id="category-form" class="text-right space-y-4">
                            <input type="hidden" id="category-id" value="${category?.id || ''}">
                            
                            <div>
                                <label class="block text-gray-700 mb-2">اسم الصنف *</label>
                                <input type="text" id="category-name" value="${category?.name || ''}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">الوصف</label>
                                <textarea id="category-description" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg">${category?.description || ''}</textarea>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">صورة الصنف (رابط أو رفع)</label>
                                <input type="url" id="category-image-url" value="${category?.image || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="https://example.com/image.jpg">
                                <input type="file" id="category-image-file" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg" onchange="app.handleCategoryImageUpload(this)">
                            </div>
                        </form>
                    `,
                    showCancelButton: true,
                    confirmButtonText: category ? 'تحديث' : 'إضافة',
                    cancelButtonText: 'إلغاء',
                    preConfirm: async () => {
                        const id = document.getElementById('category-id').value;
                        const name = document.getElementById('category-name').value;
                        const description = document.getElementById('category-description').value;
                        const imageUrl = document.getElementById('category-image-url').value;
                        const imageFile = document.getElementById('category-image-file').files[0];
                        
                        if (!name) {
                            Swal.showValidationMessage('يرجى إدخال اسم الصنف');
                            return false;
                        }
                        
                        let image = imageUrl;
                        
                        if (imageFile) {
                            try {
                                image = await this.dataManager.uploadImage(imageFile);
                            } catch (error) {
                                Swal.showValidationMessage('خطأ في رفع الصورة');
                                return false;
                            }
                        }
                        
                        return {
                            id: id ? parseInt(id) : undefined,
                            name,
                            description,
                            image: image || 'https://images.unsplash.com/photo-1577471488278-16eec37ffcc2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
                        };
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        const categoryData = result.value;
                        this.dataManager.saveCategory(categoryData);
                        this.showToast(categoryData.id ? 'تم تحديث الصنف' : 'تم إضافة الصنف');
                        this.renderAdminCategories();
                    }
                });
            }
            
            handleCategoryImageUpload(input) {
                const urlInput = document.getElementById('category-image-url');
                if (input.files && input.files[0]) {
                    urlInput.value = '';
                }
            }
            
            editCategory(categoryId) {
                this.showCategoryModal(categoryId);
            }
            
            deleteCategory(categoryId) {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم حذف الصنف وجميع المنتجات المرتبطة به',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، احذف',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#ef4444'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const category = this.dataManager.getCategory(categoryId);
                        if (category) {
                            // إزالة المنتجات المرتبطة بهذا الصنف
                            const products = this.dataManager.getProducts();
                            const updatedProducts = products.filter(p => p.category !== category.name);
                            localStorage.setItem('mithali_products', JSON.stringify(updatedProducts));
                        }
                        
                        this.dataManager.deleteCategory(categoryId);
                        this.showToast('تم حذف الصنف');
                        this.renderAdminCategories();
                    }
                });
            }
            
            // ============ وظائف إدارة العملات ============
            showCurrencyModal(currencyId = null) {
                const currency = currencyId ? this.dataManager.getCurrency(currencyId) : null;
                const defaultCurrency = this.dataManager.getDefaultCurrency();
                
                Swal.fire({
                    title: currency ? 'تعديل العملة' : 'إضافة عملة جديدة',
                    html: `
                        <form id="currency-form" class="text-right space-y-4">
                            <input type="hidden" id="currency-id" value="${currency?.id || ''}">
                            
                            <div>
                                <label class="block text-gray-700 mb-2">اسم العملة *</label>
                                <input type="text" id="currency-code" value="${currency?.code || ''}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ريال يمني">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">رمز العملة *</label>
                                <input type="text" id="currency-symbol" value="${currency?.symbol || ''}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ر.ي">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2">سعر الصرف مقابل ${defaultCurrency.code}</label>
                                <input type="number" id="currency-rate" value="${currency?.rate || 1}" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">1 ${currency?.code || 'عملة جديدة'} = <span id="rate-preview">${currency?.rate || 1}</span> ${defaultCurrency.symbol}</p>
                            </div>
                            
                            <div class="flex items-center">
                                <input type="checkbox" id="currency-is-default" ${currency?.isDefault ? 'checked' : ''} class="ml-2">
                                <label for="currency-is-default" class="text-gray-700">تعيين كعملة افتراضية</label>
                            </div>
                        </form>
                    `,
                    showCancelButton: true,
                    confirmButtonText: currency ? 'تحديث' : 'إضافة',
                    cancelButtonText: 'إلغاء',
                    preConfirm: () => {
                        const id = document.getElementById('currency-id').value;
                        const code = document.getElementById('currency-code').value;
                        const symbol = document.getElementById('currency-symbol').value;
                        const rate = document.getElementById('currency-rate').value;
                        const isDefault = document.getElementById('currency-is-default').checked;
                        
                        if (!code || !symbol) {
                            Swal.showValidationMessage('يرجى ملء جميع الحقول المطلوبة');
                            return false;
                        }
                        
                        return {
                            id: id ? parseInt(id) : undefined,
                            code,
                            symbol,
                            rate: parseFloat(rate) || 1,
                            isDefault
                        };
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        const currencyData = result.value;
                        if (currencyData.isDefault) {
                            this.dataManager.setDefaultCurrency(currencyData.id || Date.now());
                        }
                        this.dataManager.saveCurrency(currencyData);
                        this.showToast(currencyData.id ? 'تم تحديث العملة' : 'تم إضافة العملة');
                        this.renderAdminCurrencies();
                    }
                });
            }
            
            editCurrency(currencyId) {
                this.showCurrencyModal(currencyId);
            }
            
            deleteCurrency(currencyId) {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم حذف العملة نهائياً',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، احذف',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#ef4444'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.dataManager.deleteCurrency(currencyId);
                        this.showToast('تم حذف العملة');
                        this.renderAdminCurrencies();
                    }
                });
            }
            
            setDefaultCurrency(currencyId) {
                this.dataManager.setDefaultCurrency(currencyId);
                this.showToast('تم تعيين العملة كافتراضية');
                this.renderAdminCurrencies();
            }
            
            // ============ وظائف الطلبات في المدير ============
            getAdminOrdersContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة الطلبات</h2>
                                <p class="text-gray-600">عرض وإدارة جميع طلبات العملاء</p>
                            </div>
                        </div>
                        
                        <div class="flex gap-2 mb-6 overflow-x-auto pb-2">
                            <button onclick="app.filterAdminOrders('all')" class="px-4 py-2 bg-green-600 text-white rounded-lg">الكل</button>
                            <button onclick="app.filterAdminOrders('معلق')" class="px-4 py-2 bg-yellow-100 text-yellow-800 rounded-lg hover:bg-yellow-200">معلقة</button>
                            <button onclick="app.filterAdminOrders('قيد المعالجة')" class="px-4 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200">قيد المعالجة</button>
                            <button onclick="app.filterAdminOrders('مكتمل')" class="px-4 py-2 bg-green-100 text-green-800 rounded-lg hover:bg-green-200">مكتملة</button>
                            <button onclick="app.filterAdminOrders('ملغي')" class="px-4 py-2 bg-red-100 text-red-800 rounded-lg hover:bg-red-200">ملغية</button>
                        </div>
                        
                        <div class="card overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الطلب</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">العميل</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">التاريخ</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">المبلغ</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الحالة</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الإجراءات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="admin-orders-table" class="bg-white divide-y divide-gray-200">
                                        <!-- سيتم تحميل الطلبات هنا -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderAdminOrders(filter = 'all') {
                const container = document.getElementById('admin-orders-table');
                let orders = this.dataManager.getOrders();
                
                if (!container) return;
                
                orders.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                if (filter !== 'all') {
                    orders = orders.filter(order => order.status === filter);
                }
                
                if (orders.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-6 py-12 text-center">
                                <i class="fas fa-shopping-cart text-5xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد طلبات</h3>
                                <p class="text-gray-600">لم يتم استلام أي طلبات بعد</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                container.innerHTML = orders.map(order => {
                    const date = new Date(order.createdAt);
                    const formattedDate = date.toLocaleDateString('ar-YE');
                    
                    return `
                        <tr class="fade-in">
                            <td class="px-6 py-4">
                                <div class="text-sm font-medium text-gray-900">#${order.id}</div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="text-sm font-medium text-gray-900">${order.customerName || 'عميل جديد'}</div>
                                <div class="text-sm text-gray-500">${order.customerPhone || ''}</div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900">${formattedDate}</td>
                            <td class="px-6 py-4 text-sm font-bold text-gray-900">${this.dataManager.formatCurrency(order.total || 0)}</td>
                            <td class="px-6 py-4">
                                <span class="px-2 py-1 text-xs rounded-full ${this.dataManager.getStatusClass(order.status)}">
                                    ${order.status}
                                </span>
                            </td>
                            <td class="px-6 py-4 text-sm font-medium">
                                <button onclick="app.viewAdminOrder(${order.id})" class="text-green-600 hover:text-green-900 ml-4">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="app.updateOrderStatus(${order.id})" class="text-blue-600 hover:text-blue-900 ml-4">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="app.deleteOrder(${order.id})" class="text-red-600 hover:text-red-900">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                }).join('');
            }
            
            filterAdminOrders(status) {
                this.renderAdminOrders(status);
            }
            
            viewAdminOrder(orderId) {
                const order = this.dataManager.getOrders().find(o => o.id === orderId);
                if (!order) return;
                
                const itemsHtml = order.items.map(item => `
                    <div class="flex justify-between items-center p-3 border-b">
                        <div>
                            <p class="font-bold text-gray-800">${item.name}</p>
                            <p class="text-sm text-gray-600">الكمية: ${item.quantity} × ${this.dataManager.formatCurrency(item.price)}</p>
                        </div>
                        <p class="text-green-700 font-bold">${this.dataManager.formatCurrency(item.total)}</p>
                    </div>
                `).join('');
                
                Swal.fire({
                    title: `طلب #${order.id}`,
                    html: `
                        <div class="text-right">
                            <div class="mb-4">
                                <p class="text-sm text-gray-500">العميل</p>
                                <p class="font-bold text-gray-800">${order.customerName} - ${order.customerPhone}</p>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-sm text-gray-500">عنوان التوصيل</p>
                                <p class="font-bold text-gray-800">${order.customerAddress || 'غير محدد'}</p>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-sm text-gray-500">حالة الطلب</p>
                                <span class="px-3 py-1 rounded-full text-sm ${this.dataManager.getStatusClass(order.status)}">${order.status}</span>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-sm text-gray-500">المنتجات</p>
                                <div class="mt-2">
                                    ${itemsHtml}
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-lg font-bold text-gray-800">الإجمالي</span>
                                    <span class="text-2xl font-bold text-green-700">${this.dataManager.formatCurrency(order.total)}</span>
                                </div>
                            </div>
                        </div>
                    `,
                    showCloseButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'تعديل الحالة',
                    cancelButtonText: 'إغلاق'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.updateOrderStatus(orderId);
                    }
                });
            }
            
            updateOrderStatus(orderId) {
                const order = this.dataManager.getOrders().find(o => o.id === orderId);
                if (!order) return;
                
                Swal.fire({
                    title: 'تحديث حالة الطلب',
                    input: 'select',
                    inputOptions: {
                        'معلق': 'معلق',
                        'قيد المعالجة': 'قيد المعالجة',
                        'مكتمل': 'مكتمل',
                        'ملغي': 'ملغي'
                    },
                    inputValue: order.status,
                    showCancelButton: true,
                    confirmButtonText: 'تحديث',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        order.status = result.value;
                        this.dataManager.saveOrder(order);
                        this.showToast('تم تحديث حالة الطلب');
                        this.renderAdminOrders();
                    }
                });
            }
            
            deleteOrder(orderId) {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: 'سيتم حذف الطلب نهائياً',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، احذف',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#ef4444'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.dataManager.deleteOrder(orderId);
                        this.showToast('تم حذف الطلب');
                        this.renderAdminOrders();
                    }
                });
            }
            
            toggleNotifications() {
                const dropdown = document.getElementById('notifications-dropdown');
                dropdown.classList.toggle('hidden');
                
                if (!dropdown.classList.contains('hidden')) {
                    const notifications = this.dataManager.getNotifications();
                    
                    if (notifications.length === 0) {
                        dropdown.innerHTML = `
                            <div class="p-4 text-center text-gray-500">
                                <i class="fas fa-bell-slash text-2xl mb-2"></i>
                                <p>لا توجد إشعارات</p>
                        </div>
                        `;
                    } else {
                        dropdown.innerHTML = `
                            <div class="p-4 border-b">
                                <h4 class="font-bold text-gray-800">الإشعارات</h4>
                            </div>
                            <div class="max-h-96 overflow-y-auto">
                                ${notifications.slice(0, 10).map(notification => `
                                    <div class="p-4 border-b hover:bg-gray-50 ${!notification.read ? 'bg-blue-50' : ''}">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 ${notification.read ? 'bg-gray-100' : 'bg-blue-100'} rounded-full flex items-center justify-center ${notification.read ? 'text-gray-600' : 'text-blue-600'} ml-3">
                                                <i class="fas fa-bell"></i>
                                            </div>
                                            <div class="flex-1">
                                                <p class="font-bold text-gray-800">${notification.title}</p>
                                                <p class="text-sm text-gray-600">${notification.message}</p>
                                                <p class="text-xs text-gray-500 mt-1">${notification.time}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }
                }
            }
            
            // ============ الوظائف المتبقية ============
            getAdminCustomersContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة العملاء</h2>
                                <p class="text-gray-600">عرض وإدارة بيانات العملاء</p>
                            </div>
                        </div>
                        
                        <div class="card overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">الاسم</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">رقم الهاتف</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">عدد الطلبات</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">إجمالي المشتريات</th>
                                            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">آخر طلب</th>
                                        </tr>
                                    </thead>
                                    <tbody id="admin-customers-table" class="bg-white divide-y divide-gray-200">
                                        <!-- سيتم تحميل العملاء هنا -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderAdminCustomers() {
                const container = document.getElementById('admin-customers-table');
                const customers = this.dataManager.getCustomers();
                
                if (!container) return;
                
                if (customers.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-6 py-12 text-center">
                                <i class="fas fa-users text-5xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد عملاء</h3>
                                <p class="text-gray-600">لم يتم تسجيل أي عملاء بعد</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                container.innerHTML = customers.map(customer => {
                    const lastOrder = customer.lastOrder ? new Date(customer.lastOrder).toLocaleDateString('ar-YE') : 'لا يوجد';
                    
                    return `
                        <tr class="fade-in">
                            <td class="px-6 py-4">
                                <div class="text-sm font-medium text-gray-900">${customer.name}</div>
                                <div class="text-sm text-gray-500">${customer.type || 'عميل'}</div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900">${customer.phone}</td>
                            <td class="px-6 py-4 text-sm text-gray-900">${customer.totalOrders || 0}</td>
                            <td class="px-6 py-4 text-sm font-bold text-green-700">${this.dataManager.formatCurrency(customer.totalSpent || 0)}</td>
                            <td class="px-6 py-4 text-sm text-gray-900">${lastOrder}</td>
                        </tr>
                    `;
                }).join('');
            }
            
            getAdminMessagesContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">الرسائل الواردة</h2>
                                <p class="text-gray-600">إدارة رسائل واستفسارات العملاء</p>
                            </div>
                        </div>
                        
                        <div class="space-y-4" id="messages-container">
                            <!-- سيتم تحميل الرسائل هنا -->
                        </div>
                    </div>
                `;
            }
            
            renderAdminMessages() {
                const container = document.getElementById('messages-container');
                const messages = this.dataManager.getMessages();
                
                if (!container) return;
                
                if (messages.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12">
                            <i class="fas fa-envelope-open text-5xl text-gray-300 mb-4"></i>
                            <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد رسائل</h3>
                            <p class="text-gray-600">لم يتم استلام أي رسائل بعد</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = messages.map(message => {
                    const date = new Date(message.createdAt);
                    const formattedDate = date.toLocaleDateString('ar-YE') + ' ' + date.toLocaleTimeString('ar-YE');
                    
                    return `
                        <div class="card p-4 ${!message.read ? 'border-r-4 border-blue-500' : ''} fade-in">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h4 class="font-bold text-gray-800">${message.name}</h4>
                                    <p class="text-sm text-gray-600">${message.phone} • ${message.type}</p>
                                </div>
                                <div class="text-left">
                                    <span class="text-xs text-gray-500">${formattedDate}</span>
                                    ${!message.read ? `
                                        <span class="inline-block ml-2 w-2 h-2 bg-blue-500 rounded-full"></span>
                                    ` : ''}
                                </div>
                            </div>
                            <p class="text-gray-700 mb-3">${message.message}</p>
                            <div class="flex justify-end space-x-2">
                                <button onclick="app.markMessageAsRead(${message.id})" class="text-sm text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-check ml-1"></i> تم القراءة
                                </button>
                                <a href="tel:${message.phone}" class="text-sm text-green-600 hover:text-green-800">
                                    <i class="fas fa-phone ml-1"></i> اتصل
                                </a>
                                <a href="https://wa.me/${message.phone}" target="_blank" class="text-sm text-green-600 hover:text-green-800">
                                    <i class="fab fa-whatsapp ml-1"></i> واتساب
                                </a>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            markMessageAsRead(messageId) {
                this.dataManager.markMessageAsRead(messageId);
                this.renderAdminMessages();
                this.updateAdminStats();
            }
            
            getAdminFileManagementContent() {
                return `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">إدارة الملفات والإعدادات</h2>
                                <p class="text-gray-600">تصدير واستيراد البيانات وإدارة الملفات</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- تصدير البيانات -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">تصدير البيانات</h3>
                                <div class="space-y-4">
                                    <p class="text-gray-600">تصدير جميع بيانات المتجر (الإعدادات، المنتجات، الطلبات، إلخ) إلى ملف JSON.</p>
                                    <button onclick="app.exportData()" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center justify-center">
                                        <i class="fas fa-download ml-2"></i>
                                        تصدير جميع البيانات
                                    </button>
                                    <p class="text-sm text-gray-500">سيتم تنزيل ملف config.json يحتوي على جميع بيانات النظام</p>
                                </div>
                            </div>
                            
                            <!-- استيراد البيانات -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">استيراد البيانات</h3>
                                <div class="space-y-4">
                                    <p class="text-gray-600">استيراد بيانات من ملف JSON مسبق التصدير.</p>
                                    <div>
                                        <input type="file" id="import-file" accept=".json" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4">
                                        <button onclick="app.importData()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center">
                                            <i class="fas fa-upload ml-2"></i>
                                            استيراد البيانات
                                        </button>
                                    </div>
                                    <p class="text-sm text-red-500">تحذير: سيتم استبدال جميع البيانات الحالية بالبيانات المستوردة</p>
                                </div>
                            </div>
                            
                            <!-- إدارة الصور -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">إدارة الصور</h3>
                                <div class="space-y-4">
                                    <p class="text-gray-600">رفع الصور وتخزين روابطها تلقائياً.</p>
                                    <div>
                                        <input type="file" id="image-upload" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4">
                                        <button onclick="app.uploadImage()" class="w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center justify-center">
                                            <i class="fas fa-image ml-2"></i>
                                            رفع صورة
                                        </button>
                                    </div>
                                    <div id="image-preview" class="hidden">
                                        <p class="text-sm text-gray-600 mb-2">رابط الصورة:</p>
                                        <input type="text" id="image-url" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" readonly>
                                        <button onclick="app.copyImageUrl()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                                            نسخ الرابط
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- معلومات النظام -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">معلومات النظام</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">إصدار النظام:</span>
                                        <span class="font-bold">${localStorage.getItem('mithali_version') || '3.0'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">عدد المنتجات:</span>
                                        <span class="font-bold">${this.dataManager.getProducts().length}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">عدد الطلبات:</span>
                                        <span class="font-bold">${this.dataManager.getOrders().length}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">عدد العملاء:</span>
                                        <span class="font-bold">${this.dataManager.getCustomers().length}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">حجم البيانات:</span>
                                        <span class="font-bold">${Math.round(JSON.stringify(localStorage).length / 1024)} كيلوبايت</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            async exportData() {
                try {
                    const fileManager = new FileManager();
                    const success = await fileManager.exportToFile(`mithali-backup-${new Date().toISOString().split('T')[0]}.json`);
                    
                    if (success) {
                        this.showToast('تم تصدير البيانات بنجاح', 'success');
                    } else {
                        this.showToast('حدث خطأ أثناء التصدير', 'error');
                    }
                } catch (error) {
                    console.error('خطأ في التصدير:', error);
                    this.showToast('حدث خطأ أثناء التصدير', 'error');
                }
            }
            
            async importData() {
                const fileInput = document.getElementById('import-file');
                
                if (!fileInput.files || fileInput.files.length === 0) {
                    this.showToast('يرجى اختيار ملف JSON', 'error');
                    return;
                }
                
                Swal.fire({
                    title: 'استيراد البيانات',
                    text: 'هل أنت متأكد من رغبتك في استيراد البيانات؟ سيتم استبدال جميع البيانات الحالية.',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'نعم، استورد',
                    cancelButtonText: 'إلغاء',
                    confirmButtonColor: '#ef4444'
                }).then(async (result) => {
                    if (result.isConfirmed) {
                        try {
                            const fileManager = new FileManager();
                            const config = await fileManager.importFromFile(fileInput.files[0]);
                            
                            this.showToast('تم استيراد البيانات بنجاح', 'success');
                            this.dataManager.addNotification('استيراد بيانات', 'تم استيراد جميع البيانات من ملف النسخ الاحتياطي');
                            
                            // إعادة تحميل الصفحة
                            setTimeout(() => location.reload(), 1500);
                        } catch (error) {
                            this.showToast('خطأ في استيراد البيانات: ' + error.message, 'error');
                        }
                    }
                });
            }
            
            async uploadImage() {
                const fileInput = document.getElementById('image-upload');
                
                if (!fileInput.files || fileInput.files.length === 0) {
                    this.showToast('يرجى اختيار صورة', 'error');
                    return;
                }
                
                const file = fileInput.files[0];
                
                // تحقق من حجم الصورة (حد أقصى 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    this.showToast('حجم الصورة كبير جداً (الحد الأقصى 5MB)', 'error');
                    return;
                }
                
                try {
                    const fileManager = new FileManager();
                    const base64Image = await fileManager.saveImageToBase64(file);
                    
                    // عرض الرابط
                    const preview = document.getElementById('image-preview');
                    const urlInput = document.getElementById('image-url');
                    
                    urlInput.value = base64Image;
                    preview.classList.remove('hidden');
                    
                    this.showToast('تم تحويل الصورة إلى رابط', 'success');
                } catch (error) {
                    this.showToast('خطأ في معالجة الصورة', 'error');
                }
            }
            
            copyImageUrl() {
                const urlInput = document.getElementById('image-url');
                urlInput.select();
                document.execCommand('copy');
                this.showToast('تم نسخ رابط الصورة', 'success');
            }
            
            getAdminSettingsContent() {
                const settings = this.dataManager.getSettings();
                
                return `
                    <div class="fade-in">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- إعدادات المتجر -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">إعدادات المتجر</h3>
                                <form id="settings-form" onsubmit="event.preventDefault(); app.saveSettings(event)">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-gray-700 mb-2">اسم المتجر</label>
                                            <input type="text" name="companyName" value="${settings.companyName || "الميثالي للتجارة"}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2">رقم الهاتف</label>
                                                <input type="tel" name="phone" value="${settings.phone || "775555590"}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2">الواتساب</label>
                                                <input type="tel" name="whatsapp" value="${settings.whatsapp || "967775555590"}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">البريد الإلكتروني</label>
                                            <input type="email" name="email" value="${settings.email || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">العنوان</label>
                                            <textarea name="address" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg">${settings.address || "صنعاء، اليمن"}</textarea>
                                        </div>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2">معدل الضريبة (%)</label>
                                                <input type="number" name="taxRate" value="${settings.taxRate || 5}" min="0" max="100" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2">تكلفة الشحن (ر.ي)</label>
                                                <input type="number" name="shippingCost" value="${settings.shippingCost || 50000}" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">شعار المتجر (رابط أو رفع)</label>
                                            <input type="url" id="logo-url" value="${settings.logo || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="https://example.com/logo.jpg">
                                            <input type="file" id="logo-file" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg" onchange="app.handleLogoUpload(this)">
                                            ${settings.logo ? `
                                                <div class="mt-2">
                                                    <img src="${settings.logo}" alt="الشعار الحالي" class="w-20 h-20 object-cover rounded-lg">
                                                </div>
                                            ` : ''}
                                        </div>
                                        
                                        <button type="submit" class="w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                            حفظ التغييرات
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- معلومات المؤسس -->
                            <div class="card p-6">
                                <h3 class="text-lg font-bold text-gray-800 mb-6">معلومات المؤسس</h3>
                                <form id="founder-form" onsubmit="event.preventDefault(); app.saveFounderInfo(event)">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-gray-700 mb-2">اسم المؤسس</label>
                                            <input type="text" name="founderName" value="${settings.founderName || "محمد الميثالي"}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">المنصب</label>
                                            <input type="text" name="founderPosition" value="${settings.founderPosition || "المؤسس والرئيس التنفيذي"}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">السيرة الذاتية</label>
                                            <textarea name="founderBio" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg">${settings.founderBio || "مؤسس شركة الميثالي للتجارة بخبرة تزيد عن 30 عاماً في مجال المعدات الزراعية"}</textarea>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-gray-700 mb-2">صورة المؤسس (رابط أو رفع)</label>
                                            <input type="url" id="founder-image-url" value="${settings.founderImage || ''}" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="https://example.com/founder.jpg">
                                            <input type="file" id="founder-image-file" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg" onchange="app.handleFounderImageUpload(this)">
                                            ${settings.founderImage ? `
                                                <div class="mt-2">
                                                    <img src="${settings.founderImage}" alt="صورة المؤسس الحالية" class="w-20 h-20 object-cover rounded-lg">
                                                </div>
                                            ` : ''}
                                        </div>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2">كلمة مرور المدير</label>
                                                <input type="password" name="adminPassword" value="${settings.adminPassword || 'admin123'}" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                            </div>
                                        </div>
                                        
                                        <button type="submit" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                            حفظ معلومات المؤسس
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            handleLogoUpload(input) {
                const urlInput = document.getElementById('logo-url');
                if (input.files && input.files[0]) {
                    urlInput.value = '';
                }
            }
            
            handleFounderImageUpload(input) {
                const urlInput = document.getElementById('founder-image-url');
                if (input.files && input.files[0]) {
                    urlInput.value = '';
                }
            }
            
            async saveSettings(event) {
                const formData = new FormData(event.target);
                const logoUrl = document.getElementById('logo-url').value;
                const logoFile = document.getElementById('logo-file').files[0];
                
                let logo = logoUrl;
                
                if (logoFile) {
                    try {
                        logo = await this.dataManager.uploadImage(logoFile);
                    } catch (error) {
                        this.showToast('خطأ في رفع صورة الشعار', 'error');
                        return;
                    }
                }
                
                const settings = {
                    companyName: formData.get('companyName'),
                    phone: formData.get('phone'),
                    whatsapp: formData.get('whatsapp'),
                    email: formData.get('email'),
                    address: formData.get('address'),
                    taxRate: parseFloat(formData.get('taxRate')) || 5,
                    shippingCost: parseFloat(formData.get('shippingCost')) || 50000,
                    logo: logo,
                    founderName: this.dataManager.getSettings().founderName,
                    founderPosition: this.dataManager.getSettings().founderPosition,
                    founderBio: this.dataManager.getSettings().founderBio,
                    founderImage: this.dataManager.getSettings().founderImage,
                    adminPassword: this.dataManager.getSettings().adminPassword
                };
                
                this.dataManager.saveSettings(settings);
                this.showToast('تم حفظ الإعدادات بنجاح');
                this.updateFooterInfo();
                this.updateLogo();
            }
            
            async saveFounderInfo(event) {
                const formData = new FormData(event.target);
                const founderImageUrl = document.getElementById('founder-image-url').value;
                const founderImageFile = document.getElementById('founder-image-file').files[0];
                
                let founderImage = founderImageUrl;
                
                if (founderImageFile) {
                    try {
                        founderImage = await this.dataManager.uploadImage(founderImageFile);
                    } catch (error) {
                        this.showToast('خطأ في رفع صورة المؤسس', 'error');
                        return;
                    }
                }
                
                const settings = this.dataManager.getSettings();
                settings.founderName = formData.get('founderName');
                settings.founderPosition = formData.get('founderPosition');
                settings.founderBio = formData.get('founderBio');
                settings.founderImage = founderImage;
                settings.adminPassword = formData.get('adminPassword') || settings.adminPassword;
                
                this.dataManager.saveSettings(settings);
                this.showToast('تم حفظ معلومات المؤسس بنجاح');
            }
        }

        // ==================== تهيئة التطبيق ====================
        const app = new MithaliApp();

        // إضافة أنماط لزر الفاب
        const fabStyles = document.createElement('style');
        fabStyles.textContent = `
            .fab-container {
                position: fixed;
                bottom: 24px;
                left: 24px;
                display: flex;
                flex-direction: column;
                gap: 12px;
                z-index: 100;
            }
            
            .fab {
                width: 56px;
                height: 56px;
                border-radius: 50%;
                background: linear-gradient(135deg, var(--primary), var(--secondary));
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 20px rgba(6, 78, 59, 0.3);
                cursor: pointer;
                transition: all 0.3s ease;
                border: none;
                outline: none;
            }
            
            .fab:hover {
                transform: scale(1.1);
                box-shadow: 0 6px 25px rgba(6, 78, 59, 0.4);
            }
            
            .fab-small {
                width: 44px;
                height: 44px;
                bottom: 90px;
            }
            
            .fab i {
                font-size: 1.25rem;
            }
            
            .fab-small i {
                font-size: 1rem;
            }
        `;
        document.head.appendChild(fabStyles);
    </script>
</body>
                                                           </html>
